{"remainingRequest":"/node/src/code-factory/node_modules/babel-loader/lib/index.js!/node/src/code-factory/lsrkyyezwbvy/src/mixins/action.js","dependencies":[{"path":"/node/src/code-factory/lsrkyyezwbvy/src/mixins/action.js","mtime":1649314959952},{"path":"/node/src/code-factory/lsrkyyezwbvy/babel.config.js","mtime":1649314958358},{"path":"/node/src/code-factory/node_modules/cache-loader/dist/cjs.js","mtime":1648824486287},{"path":"/node/src/code-factory/node_modules/babel-loader/lib/index.js","mtime":1648824338096}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0FycmF5IGZyb20gIi9ub2RlL3NyYy9jb2RlLWZhY3Rvcnkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQXJyYXkuanMiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICIvbm9kZS9zcmMvY29kZS1mYWN0b3J5L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyLmpzIjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICIvbm9kZS9zcmMvY29kZS1mYWN0b3J5L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eS5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICIvbm9kZS9zcmMvY29kZS1mYWN0b3J5L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICIvbm9kZS9zcmMvY29kZS1mYWN0b3J5L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheS5qcyI7Cgp2YXIgX21ldGhvZHM7CgppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmpzb24uc3RyaW5naWZ5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZS5qcyI7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcGFyYW1Kc29uOiB7fSwKICAgICAgZ2xvYmFsVmFyaWFibGVMaXN0OiB7fSwKICAgICAgdGltZXI6IG51bGwsCiAgICAgIG9wdGlvbjoge30KICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgaXNXZWI6IGZ1bmN0aW9uIGlzV2ViKCkgewogICAgICByZXR1cm4gZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aCA+PSA3NTA7CiAgICB9LAogICAgaXNINTogZnVuY3Rpb24gaXNINSgpIHsKICAgICAgcmV0dXJuIDc1MCA+IGRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGg7CiAgICB9LAogICAgY3VzdG9tU3R5bGU6IGZ1bmN0aW9uIGN1c3RvbVN0eWxlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uICh1dWlkKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLmlzV2ViID8gIlBDIi5jb25jYXQodXVpZCkgOiAiSDUiLmNvbmNhdCh1dWlkKTsKICAgICAgfTsKICAgIH0sCiAgICBjbGFzc1N0eWxlOiBmdW5jdGlvbiBjbGFzc1N0eWxlKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBmdW5jdGlvbiAodXVpZCkgewogICAgICAgIHZhciBvYmogPSB7fTsKICAgICAgICB2YXIgY2xhc3NOYW1lcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoX3RoaXMyLmNvbnRyb2xQcm9wZXJ0aWVzW3V1aWRdLmNsYXNzTmFtZSkpOwoKICAgICAgICBpZiAoX3RoaXMyLmlzV2ViKSB7CiAgICAgICAgICBjbGFzc05hbWVzLnBjQ2xhc3MucmV2ZXJzZSgpLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgb2JqW2l0ZW1dID0gdHJ1ZTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjbGFzc05hbWVzLm1DbGFzcy5yZXZlcnNlKCkuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICBvYmpbaXRlbV0gPSB0cnVlOwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gb2JqOwogICAgICB9OwogICAgfQogIH0sCiAgbWV0aG9kczogKF9tZXRob2RzID0gewogICAgLyog5qCh6aqMCiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IOmcgOimgeagoemqjOeahOaOp+S7tgogICAgICovCiAgICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUoKSB7CiAgICAgIHZhciBsaXN0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBbXTsKICAgICAgdmFyIHZhbGlkYXRlTGlzdCA9IHRoaXMuZ2V0VmFsaWRhdGVMaXN0KHRoaXMuJGNoaWxkcmVuKS5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gbGlzdC5pbmNsdWRlcyhpdGVtLnByb3ApOwogICAgICB9KTsKICAgICAgdmFyIGZsYWcgPSB0cnVlOwoKICAgICAgaWYgKHZhbGlkYXRlTGlzdC5sZW5ndGgpIHsKICAgICAgICB2YWxpZGF0ZUxpc3QuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgaWYgKCFpdGVtLnRpZ2dlclZhbGlkYXRlKCkpIHsKICAgICAgICAgICAgZmxhZyA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gZmxhZzsKICAgIH0sCiAgICBnZXRWYWxpZGF0ZUxpc3Q6IGZ1bmN0aW9uIGdldFZhbGlkYXRlTGlzdChsaXN0KSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIHJlc3VsdExpc3QgPSBbXTsKICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaWYgKGl0ZW0uJG9wdGlvbnMubmFtZSA9PT0gInZhbGlkYXRlIikgewogICAgICAgICAgcmVzdWx0TGlzdC5wdXNoKGl0ZW0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKGl0ZW0uJGNoaWxkcmVuICYmIGl0ZW0uJGNoaWxkcmVuLmxlbmd0aCkgewogICAgICAgICAgcmVzdWx0TGlzdC5wdXNoLmFwcGx5KHJlc3VsdExpc3QsIF90b0NvbnN1bWFibGVBcnJheShfdGhpczMuZ2V0VmFsaWRhdGVMaXN0KGl0ZW0uJGNoaWxkcmVuKSkpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiByZXN1bHRMaXN0OwogICAgfSwKICAgIHNldENvbnRyb2xWYWw6IGZ1bmN0aW9uIHNldENvbnRyb2xWYWwodmFsLCBiYXNlVHlwZSwgdHlwZSkgewogICAgICBpZiAodHlwZSA9PT0gJ0FkZHJlc3MnICYmIGJhc2VUeXBlICE9PSAnQWRkcmVzcycpIHsKICAgICAgICB0cnkgewogICAgICAgICAgdmFyIHZhbHVlID0gdHlwZW9mIHZhbCA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKHZhbCkgOiB2YWw7CiAgICAgICAgICByZXR1cm4gdmFsdWUubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiBpdGVtLm5hbWU7CiAgICAgICAgICB9KS5qb2luKCIvIik7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0KICAgICAgfQoKICAgICAgOwoKICAgICAgaWYgKHR5cGUgPT09ICdGaWxlJyAmJiBiYXNlVHlwZSAhPT0gJ0ZpbGVVcGxvYWQnKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHZhciBfdmFsdWUgPSB0eXBlb2YgdmFsID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UodmFsKSA6IHZhbDsKCiAgICAgICAgICByZXR1cm4gX3ZhbHVlLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICByZXR1cm4gaXRlbS50aXRsZTsKICAgICAgICAgIH0pLmpvaW4oIi8iKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgfQogICAgICB9CgogICAgICA7CiAgICAgIHJldHVybiB2YWw7CiAgICB9LAogICAgc2hvd0ZuOiBmdW5jdGlvbiBzaG93Rm4oc3RhdHVzLCAkc2NvcGVkLCB1dWlkKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgZGVmYXVsdEZsYWcsIGp1ZGUsIGZsYWc7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgZGVmYXVsdEZsYWcgPSBzdGF0dXMuZGlzcGxheSA9PT0gJ3Nob3cnOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coc3RhdHVzLCAkc2NvcGVkKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNC5jb25kaXRpb25KdWRnZShzdGF0dXMuZGlzcGxheUNvbmRpdGlvbiwgbnVsbCwgJHNjb3BlZCk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIGp1ZGUgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgZmxhZyA9IGRlZmF1bHRGbGFnID8gIShqdWRlICYmIGRlZmF1bHRGbGFnKSA6IGRlZmF1bHRGbGFnIHx8IGp1ZGU7CiAgICAgICAgICAgICAgICAkc2NvcGVkWyJkaXNwbGF5Ii5jb25jYXQodXVpZCldID0gZmxhZzsKCiAgICAgICAgICAgICAgICBfdGhpczQuJHNldCgkc2NvcGVkLCBfZGVmaW5lUHJvcGVydHkoe30sICJkaXNwbGF5Ii5jb25jYXQodXVpZCksIGZsYWcpKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGdldENvbnRyb2xGbG93VmFsOiBmdW5jdGlvbiBnZXRDb250cm9sRmxvd1ZhbChjb250cm9sVXVpZCwgZWxlbWVudCkgewogICAgICB2YXIgX3RoaXMkY29udHJvbFByb3BlcnRpOwoKICAgICAgdmFyIHZhbHVlID0gdGhpcy5jb250cm9sUHJvcGVydGllc1sidiIuY29uY2F0KGNvbnRyb2xVdWlkKV0udmFsdWU7CiAgICAgIHZhciB0eXBlID0gKF90aGlzJGNvbnRyb2xQcm9wZXJ0aSA9IHRoaXMuY29udHJvbFByb3BlcnRpZXNbInYiLmNvbmNhdChjb250cm9sVXVpZCldKSA9PT0gbnVsbCB8fCBfdGhpcyRjb250cm9sUHJvcGVydGkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGNvbnRyb2xQcm9wZXJ0aS50eXBlOwoKICAgICAgaWYgKHR5cGUgJiYgWyJWaWRlbyIsICJBdWRpbyIsICJGaWxlVXBsb2FkIl0uaW5jbHVkZXModHlwZSkpIHsKICAgICAgICB2YWx1ZSA9IHR5cGVvZiB0aGlzLmNvbnRyb2xQcm9wZXJ0aWVzWyJ2Ii5jb25jYXQoY29udHJvbFV1aWQpXS52YWx1ZSA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKHRoaXMuY29udHJvbFByb3BlcnRpZXNbInYiLmNvbmNhdChjb250cm9sVXVpZCldLnZhbHVlKSA6IHRoaXMuY29udHJvbFByb3BlcnRpZXNbInYiLmNvbmNhdChjb250cm9sVXVpZCldLnZhbHVlOwogICAgICB9IGVsc2UgaWYgKGNvbnRyb2xVdWlkICYmIFsnVGFibGVWaWV3JywgJ0NhcmRWaWV3JywgJ0xpc3RWaWV3JywgJ1RhYmxlQ29udGFpbmVyJywgJ0Zvcm1MaXN0J10uaW5jbHVkZXModHlwZSkpIHsKICAgICAgICB2YXIgX2VsZW1lbnQkY2hpbGRyZW47CgogICAgICAgIGlmICgoZWxlbWVudCA9PT0gbnVsbCB8fCBlbGVtZW50ID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2VsZW1lbnQkY2hpbGRyZW4gPSBlbGVtZW50LmNoaWxkcmVuKSA9PT0gbnVsbCB8fCBfZWxlbWVudCRjaGlsZHJlbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2VsZW1lbnQkY2hpbGRyZW4ubGVuZ3RoKSA+IDApIHsKICAgICAgICAgIC8v5pyJ5a2Q6ZuGCiAgICAgICAgICBpZiAoWydGb3JtTGlzdCddLmluY2x1ZGVzKHR5cGUpKSB7CiAgICAgICAgICAgIHZhciBsaXN0ID0gdGhpcy5nZXRGb3JtTGlzdEluc2VydERhdGEoY29udHJvbFV1aWQpLmluc2VydENvbnRlbnQ7CiAgICAgICAgICAgIHZhciB2YWxMaXN0ID0gW107CiAgICAgICAgICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbiAodmFsSXRlbSkgewogICAgICAgICAgICAgIHZhciBvYmogPSB7fTsKICAgICAgICAgICAgICB2YWxJdGVtLmluc2VydC5mb3JFYWNoKGZ1bmN0aW9uIChzSXRlbSkgewogICAgICAgICAgICAgICAgZWxlbWVudC5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgIHZhciBwYXJhbXNOYW1lID0gaXRlbS5wYXJhbXNOYW1lOwogICAgICAgICAgICAgICAgICBvYmpbcGFyYW1zTmFtZV0gPSBzSXRlbS52YWx1ZTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdmFsTGlzdC5wdXNoKG9iaik7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB2YWx1ZSA9IHZhbExpc3Q7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXIgaWRzID0gdGhpcy5jb250cm9sUHJvcGVydGllc1sidiIuY29uY2F0KGNvbnRyb2xVdWlkKV0udmFsdWU7CgogICAgICAgICAgICB2YXIgX2xpc3QgPSB0aGlzLmNvbnRyb2xQcm9wZXJ0aWVzWyJ2Ii5jb25jYXQoZWxlbWVudC5jb250cm9sVXVpZCldLmRhdGFTb3VyY2VMaXN0LmZpbHRlcihmdW5jdGlvbiAodikgewogICAgICAgICAgICAgIHJldHVybiBpZHMuZmluZChmdW5jdGlvbiAobSkgewogICAgICAgICAgICAgICAgcmV0dXJuIG0gPT09IHYuaWQ7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgdmFyIF92YWxMaXN0ID0gW107CgogICAgICAgICAgICBfbGlzdC5mb3JFYWNoKGZ1bmN0aW9uICh2YWxJdGVtKSB7CiAgICAgICAgICAgICAgdmFyIG9iaiA9IHt9OwogICAgICAgICAgICAgIGVsZW1lbnQuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgdmFyIGtleUl0ZW0gPSBpdGVtLnN1YkNvbnRyb2xVdWlkOwogICAgICAgICAgICAgICAgdmFyIHBhcmFtc05hbWUgPSBpdGVtLnBhcmFtc05hbWU7CiAgICAgICAgICAgICAgICBvYmpbcGFyYW1zTmFtZV0gPSB2YWxJdGVtW2tleUl0ZW1dOwogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBfdmFsTGlzdC5wdXNoKG9iaik7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgdmFsdWUgPSBfdmFsTGlzdDsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy/ml6DlrZDpm4YKICAgICAgICAgIGlmICghY29udHJvbC5kYXRhUHJvcGVydHkuc2hvd1Jvd1NlbGVjdGlvbikgewogICAgICAgICAgICB2YWx1ZSA9IHRoaXMuc2VsZWN0TGlzdFtjb250cm9sVXVpZF0ucmVzdWx0RGF0YS5tYXAoZnVuY3Rpb24gKHYpIHsKICAgICAgICAgICAgICByZXR1cm4gdi5pZDsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YWx1ZSA9IHRoaXMuY29udHJvbFZhbHVlc1tjb250cm9sVXVpZF07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gdmFsdWU7CiAgICB9LAogICAgLy8g6K6+572u5a655Zmo5p2h5Lu2CiAgICBzZXRXaGVyZTogZnVuY3Rpb24gc2V0V2hlcmUod2hlcmUpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB3aGVyZS5vciAmJiB3aGVyZS5vci5mb3JFYWNoKGZ1bmN0aW9uIChvckl0ZW0pIHsKICAgICAgICBvckl0ZW0uYW5kICYmIG9ySXRlbS5hbmQuZm9yRWFjaChmdW5jdGlvbiAoYW5kSXRlbSkgewogICAgICAgICAgaWYgKGFuZEl0ZW0uc291dGggPT09ICdjb250cm9sVmFsdWUnKSB7CiAgICAgICAgICAgIHZhciB2YWwgPSBfdGhpczUuZ2V0Q29udHJvbEZsb3dWYWwoYW5kSXRlbS5jb250cm9scywgYW5kSXRlbSk7CgogICAgICAgICAgICBhbmRJdGVtLnZhbHVlID0gdmFsOwogICAgICAgICAgICBhbmRJdGVtLnJpZ2h0ID0gdmFsOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChhbmRJdGVtLnNvdXRoID09PSAncGFnZXBhcmFtcycpIHsKICAgICAgICAgICAgYW5kSXRlbS52YWx1ZSA9IF90aGlzNS4kcm91dGUucXVlcnlbYW5kSXRlbS5wYWdlcGFyYW1zW2FuZEl0ZW0ucGFnZXBhcmFtcy5sZW5ndGggLSAxXV07CiAgICAgICAgICAgIGFuZEl0ZW0ucmlnaHQgPSBfdGhpczUuJHJvdXRlLnF1ZXJ5W2FuZEl0ZW0ucGFnZXBhcmFtc1thbmRJdGVtLnBhZ2VwYXJhbXMubGVuZ3RoIC0gMV1dOwogICAgICAgICAgfQoKICAgICAgICAgIGFuZEl0ZW0udGFibGVfdXVpZCA9IGFuZEl0ZW0udGFibGVfdXVpZCB8fCB3aGVyZVBhcmFtcy5tb2RlbF91dWlkOwoKICAgICAgICAgIGlmIChhbmRJdGVtLnJpZ2h0ID09PSAnJykge30KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgY29uZGl0aW9uSnVkZ2U6IGZ1bmN0aW9uIGNvbmRpdGlvbkp1ZGdlKG9yTGlzdCwgZ2xvYmFsVmFyaWFibGVMaXN0LCAkc2NvcGVkKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIHN0ciwgaiwgb3JJdGVtLCBhbmRTdHIsIGksIGFuZEl0ZW0sIHYxLCB2MiwgdHlwZSwgX3N0ciwganNTdHI7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAvL+adoeS7tuWIpOaWrQogICAgICAgICAgICAgICAgc3RyID0gW107CiAgICAgICAgICAgICAgICBqID0gMDsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgaWYgKCEoaiA8IG9yTGlzdC5sZW5ndGgpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIG9ySXRlbSA9IG9yTGlzdFtqXTsKICAgICAgICAgICAgICAgIGFuZFN0ciA9IFtdOwogICAgICAgICAgICAgICAgaSA9IDA7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIGlmICghKGkgPCBvckl0ZW0uYW5kLmxlbmd0aCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgYW5kSXRlbSA9IG9ySXRlbS5hbmRbaV07CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNi5nZXRWYWwoYW5kSXRlbS5iZWZvcmVNYXRjaFR5cGUsIGdsb2JhbFZhcmlhYmxlTGlzdCwgJHNjb3BlZCk7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICB2MSA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczYuZ2V0VmFsKGFuZEl0ZW0uYWZ0ZXJNYXRjaFR5cGUsIGdsb2JhbFZhcmlhYmxlTGlzdCwgJHNjb3BlZCk7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICB2MiA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgdHlwZSA9IGFuZEl0ZW0ubWF0Y2hUeXBlOwogICAgICAgICAgICAgICAgX3N0ciA9ICInIi5jb25jYXQodjEsICInIikuY29uY2F0KHR5cGUsICInIikuY29uY2F0KHYyLCAiJyIpOwoKICAgICAgICAgICAgICAgIGlmIChbJz49JywgJz4nLCAnPD0nLCAnPCddLmluY2x1ZGVzKHR5cGUpKSB7CiAgICAgICAgICAgICAgICAgIF9zdHIgPSAiIi5jb25jYXQodjEpLmNvbmNhdCh0eXBlKS5jb25jYXQodjIpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChbJ2luY2x1ZGVzJywgJ3N0YXJ0V2l0aCcsICdlbmRzV2l0aCddLmluY2x1ZGVzKHR5cGUpKSB7CiAgICAgICAgICAgICAgICAgIC8v5YyF5ZCr77yM5byA5aeL77yM57uT5p2fCiAgICAgICAgICAgICAgICAgIF9zdHIgPSAiJyIuY29uY2F0KHYxLCAiJy4iKS5jb25jYXQodHlwZSwgIignIikuY29uY2F0KHYyLCAiJykiKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJyFpbmNsdWRlcycpIHsKICAgICAgICAgICAgICAgICAgLy/ljIXlkKsKICAgICAgICAgICAgICAgICAgX3N0ciA9ICIhJyIuY29uY2F0KHYxLCAiJy5pbmNsdWRlcygnIikuY29uY2F0KHYyLCAiJykiKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoWyI9PScnIl0uaW5jbHVkZXModHlwZSkpIHsKICAgICAgICAgICAgICAgICAgLy/kuLrnqboKICAgICAgICAgICAgICAgICAgX3N0ciA9ICIoJyIuY29uY2F0KHYxLCAiJz09Jyd8fCciKS5jb25jYXQodjEsICInLmxlbmd0aD09MCkiKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoWyIhPScnIl0uaW5jbHVkZXModHlwZSkpIHsKICAgICAgICAgICAgICAgICAgLy/kuI3kuLrnqboKICAgICAgICAgICAgICAgICAgX3N0ciA9ICIoJyIuY29uY2F0KHYxLCAiJyE9JycmJiciKS5jb25jYXQodjEsICInLmxlbmd0aD4wKSIpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGFuZFN0ci5wdXNoKF9zdHIpOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3YxPScsIHYxLCAndjI9JywgdjIsICdhbmRTdHInLCBhbmRTdHIpOwoKICAgICAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgICAgICAgaSsrOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA2OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjY6CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnYW5kJywgYW5kU3RyKTsKICAgICAgICAgICAgICAgIHN0ci5wdXNoKGFuZFN0ci5qb2luKCcmJicpKTsKCiAgICAgICAgICAgICAgY2FzZSAyODoKICAgICAgICAgICAgICAgIGorKzsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDMxOgogICAgICAgICAgICAgICAganNTdHIgPSBzdHIuam9pbignfHwnKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMzI7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgZXZhbChqc1N0cikgfHwgZmFsc2UpOwoKICAgICAgICAgICAgICBjYXNlIDM2OgogICAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAzNjsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IF9jb250ZXh0MlsiY2F0Y2giXSgzMik7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn5Yik5pat5Ye66ZSZJywgX2NvbnRleHQyLnQwKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBmYWxzZSk7CgogICAgICAgICAgICAgIGNhc2UgNDA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIsIG51bGwsIFtbMzIsIDM2XV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBzdGFydDogZnVuY3Rpb24gc3RhcnQoX3N0YXJ0LCBmbG93TWFwLCBwYXJhbXNBcnIsIG5leHQpIHsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIHNldFZhbHVlOiBmdW5jdGlvbiBzZXRWYWx1ZShfc2V0VmFsdWUsIGZsb3dNYXAsIHBhcmFtc0FyciwgbmV4dCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICAgIHZhciBsaXN0LCBzZXRWYWx1ZUxpc3QsIGksIGl0ZW0sIHZhbDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgbGlzdCA9IFtdOwoKICAgICAgICAgICAgICAgIGlmIChfc2V0VmFsdWUubGlzdCAmJiBfc2V0VmFsdWUubGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgIGxpc3QgPSBfc2V0VmFsdWUubGlzdDsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGxpc3QgPSBfc2V0VmFsdWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgc2V0VmFsdWVMaXN0ID0gbGlzdC5tYXAoZnVuY3Rpb24gKHYpIHsKICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSB2OwogICAgICAgICAgICAgICAgICBpdGVtLnNvdXJjZSA9IGl0ZW0uc291cmNlIHx8IGl0ZW0uYWN0aW9uVHlwZTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGkgPSAwOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICBpZiAoIShpIDwgc2V0VmFsdWVMaXN0Lmxlbmd0aCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxMzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaXRlbSA9IHNldFZhbHVlTGlzdFtpXTsKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gODsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczcuZ2V0VmFsKGl0ZW0sIHBhcmFtc0FyciA9PT0gbnVsbCB8fCBwYXJhbXNBcnIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBhcmFtc0Fyci5nbG9iYWxWYXJpYWJsZUxpc3QsIF90aGlzNy50YWJsZUl0ZW0pOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICB2YWwgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgICAgIF90aGlzNy5jb250cm9sUHJvcGVydGllc1sidiIuY29uY2F0KGl0ZW0uY29udHJvbFRhcmdldFV1aWQpXS52YWx1ZSA9IHZhbDsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgX3RoaXM3LmdvTmV4dChuZXh0LCBmbG93TWFwLCBwYXJhbXNBcnIpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZGVsYXlUaGU6IGZ1bmN0aW9uIGRlbGF5VGhlKF9kZWxheVRoZSwgZmxvd01hcCwgcGFyYW1zQXJyLCBuZXh0KSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoKSB7CiAgICAgICAgdmFyIHRoLCBkZWxheU51bWJlciwgZGVsYXlUeXBlLCBudW07CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIC8v5bu26L+f5omn6KGMCiAgICAgICAgICAgICAgICB0aCA9IF90aGlzODsKICAgICAgICAgICAgICAgIGRlbGF5TnVtYmVyID0gX2RlbGF5VGhlLmRlbGF5TnVtYmVyLCBkZWxheVR5cGUgPSBfZGVsYXlUaGUuZGVsYXlUeXBlOwogICAgICAgICAgICAgICAgbnVtID0gZGVsYXlUeXBlID09PSAncycgPyBkZWxheU51bWJlciAqIDEwMDAgOiBkZWxheU51bWJlcjsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICBfdGhpczguZ29OZXh0KG5leHQsIGZsb3dNYXAsIHBhcmFtc0Fycik7CiAgICAgICAgICAgICAgICB9LCBudW0pOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBpbml0Rm9ybURldGFpbDogZnVuY3Rpb24gaW5pdEZvcm1EZXRhaWwoX2luaXRGb3JtRGV0YWlsLCBmbG93TWFwLCBwYXJhbXNBcnIsIG5leHQpIHsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGludm9rZUZsb3c6IGZ1bmN0aW9uIGludm9rZUZsb3coX2ludm9rZUZsb3csIGZsb3dNYXAsIHBhcmFtc0FyciwgaW52b2tlRmxvd05leHQpIHsKICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNygpIHsKICAgICAgICB2YXIgcmVxLCByZXMsIHByb2Nlc3NJZCwgZm9ybURhdGEsIGksIGVsZW1lbnQsIF9yZXMsIHBhcmFtcywgX3Jlc3BvbnNlLCBibG9iLCByZWFkZXIsIHJlc3BvbnNlLCBkYXRhOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcmVxID0gKF9pbnZva2VGbG93ID09PSBudWxsIHx8IF9pbnZva2VGbG93ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfaW52b2tlRmxvdy5yZXEpIHx8IFtdOwogICAgICAgICAgICAgICAgcmVzID0gX2ludm9rZUZsb3cgPT09IG51bGwgfHwgX2ludm9rZUZsb3cgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9pbnZva2VGbG93LnJlczsKICAgICAgICAgICAgICAgIHByb2Nlc3NJZCA9IF9pbnZva2VGbG93ID09PSBudWxsIHx8IF9pbnZva2VGbG93ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfaW52b2tlRmxvdy5wcm9jZXNzSWQ7CiAgICAgICAgICAgICAgICBmb3JtRGF0YSA9IHsKICAgICAgICAgICAgICAgICAgc3lzdGVtX3BiOiB7fQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGkgPSAwOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBpZiAoIShpIDwgcmVxLmxlbmd0aCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAyNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZWxlbWVudCA9IHJlcVtpXTsKCiAgICAgICAgICAgICAgICBpZiAoIShlbGVtZW50LnNvdXJjZSA9PT0gInVybCIpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGZvcm1EYXRhW2VsZW1lbnQucGFyYW1zTmFtZV0gPSBfdGhpczkuJHJvdXRlLnF1ZXJ5W2VsZW1lbnQuZmllbGRwYXJhbU5hbWVdOwogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAyMzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgaWYgKCEoZWxlbWVudC5zb3VyY2UgPT09ICJwYWdlIikpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAxNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuY29udHJvbFV1aWQpIHsKICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuc3ViQ29udHJvbFV1aWQpIHsKICAgICAgICAgICAgICAgICAgICBmb3JtRGF0YVtlbGVtZW50LnBhcmFtc05hbWVdID0gX3RoaXM5LnRhYmxlSXRlbVtlbGVtZW50LnN1YkNvbnRyb2xVdWlkXTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBmb3JtRGF0YVtlbGVtZW50LnBhcmFtc05hbWVdID0gX3RoaXM5LmdldENvbnRyb2xGbG93VmFsKGVsZW1lbnQuY29udHJvbFV1aWQsIGVsZW1lbnQpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAyMzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgaWYgKCEoZWxlbWVudC5zb3VyY2UgPT09ICJnbG9iYWxWYWx1ZSIpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMjI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTg7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM5LiRnZXQoIi9wcm9jZXNzL3YxL3F1ZXJ5R2xvYmFsVmFsdWVCeUtleSIsIHsKICAgICAgICAgICAgICAgICAgZmllbGROYW1lS2V5OiBlbGVtZW50LmZpZWxkTmFtZUtleQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgICAgICBfcmVzID0gX2NvbnRleHQ3LnNlbnQ7CiAgICAgICAgICAgICAgICBmb3JtRGF0YVtlbGVtZW50LnBhcmFtc05hbWVdID0gX3Jlcy5kYXRhLmZpZWxkTmFtZVZhbHVlOwogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAyMzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuc291cmNlID09PSAiZ2xvYmFsVmFyaWFibGVWYWx1ZSIpIHsKICAgICAgICAgICAgICAgICAgZm9ybURhdGFbZWxlbWVudC5wYXJhbXNOYW1lXSA9IHBhcmFtc0Fyci5nbG9iYWxWYXJpYWJsZUxpc3RbZWxlbWVudC5nbG9iYWxWYXJpYWJsZVZhbHVlXTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDI2OgogICAgICAgICAgICAgICAgcGFyYW1zID0gewogICAgICAgICAgICAgICAgICBwcm9jZXNzSnNvblVVaWQ6IHByb2Nlc3NJZCwKICAgICAgICAgICAgICAgICAgcGFyYW1zSnNvbjogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgIGRhdGE6IGZvcm1EYXRhCiAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIGlmICghKHJlcyAmJiByZXMubGVuZ3RoID09PSAxICYmIHJlc1swXS5yZXNwb25zZS5sZW5ndGggPT09IDEgJiYgcmVzWzBdLnJlc3BvbnNlWzBdLnBhcmFtc1R5cGUgPT09ICdGaWxlSW8nKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDM2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDMwOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzOS4kcG9zdEdldGZpbGUoIi9wcm9jZXNzL3YxLyIuY29uY2F0KF9pbnZva2VGbG93ID09PSBudWxsIHx8IF9pbnZva2VGbG93ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfaW52b2tlRmxvdy5wcm9jZXNzSWQpLCBwYXJhbXMsIHsKICAgICAgICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiAnYmxvYicsCiAgICAgICAgICAgICAgICAgIGdldFJlc3BvbnNlOiB0cnVlCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAzMDoKICAgICAgICAgICAgICAgIF9yZXNwb25zZSA9IF9jb250ZXh0Ny5zZW50OwogICAgICAgICAgICAgICAgYmxvYiA9IF9yZXNwb25zZS5kYXRhOwogICAgICAgICAgICAgICAgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGJsb2IpOwoKICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICB2YXIgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICAgICAgICAgICAgYS5kb3dubG9hZCA9IGRlY29kZVVSSShfcmVzcG9uc2UuaGVhZGVyc1snY29udGVudC1kaXNwb3NpdGlvbiddLnNwbGl0KCdmaWxlbmFtZT0nKVsxXSk7CiAgICAgICAgICAgICAgICAgIGEuaHJlZiA9IGUudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTsKICAgICAgICAgICAgICAgICAgYS5jbGljaygpOwogICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGEpOwogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMzY6CiAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDM4OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzOS4kcG9zdCgiL3Byb2Nlc3MvdjEvIi5jb25jYXQoX2ludm9rZUZsb3cgPT09IG51bGwgfHwgX2ludm9rZUZsb3cgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9pbnZva2VGbG93LnByb2Nlc3NJZCksIHBhcmFtcyk7CgogICAgICAgICAgICAgIGNhc2UgMzg6CiAgICAgICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0Ny5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgICAgICByZXMubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgIGlmIChpdGVtLnJlc3Jlc3VsdFR5cGUuaW5jbHVkZXMoZGF0YS5zeXN0ZW1fcmV0dXJuQmVsb25nKSkgewogICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLnJlc3Jlc3VsdCA9PT0gImZsb3dyZXNwYWdlIikgewogICAgICAgICAgICAgICAgICAgICAgaXRlbS5yZXNwb25zZS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzOS5zZXRDb250cm9sUHJvcGVydGllcyhlbGVtZW50LCBkYXRhW2VsZW1lbnQucGFyYW1zTmFtZV0sIHBhcmFtcywgcGFyYW1zQXJyKTsKICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnZva2VGbG93TmV4dCAmJiBpbnZva2VGbG93TmV4dC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2ID0gaW52b2tlRmxvd05leHQuZmluZChmdW5jdGlvbiAodikgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2LnJlc0JlbG9uZ2lkID09PSBkYXRhLnN5c3RlbV9yZXR1cm5CZWxvbmc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pLk5leHQ7CgogICAgICAgICAgICAgICAgICAgICAgICBfdGhpczkubG9vcCh2LCBmbG93TWFwLCBwYXJhbXNBcnIpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczkubG9vcChpdGVtLmFjdGlvbk5leHQsIGZsb3dNYXAsIHBhcmFtc0Fycik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA0MToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNyk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIG1lc3NhZ2VUaXBzOiBmdW5jdGlvbiBtZXNzYWdlVGlwcyhfbWVzc2FnZVRpcHMsIGZsb3dNYXAsIHBhcmFtc0FyciwgbmV4dCkgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOCgpIHsKICAgICAgICB2YXIgX3RoOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTgkKF9jb250ZXh0OCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMxMC4kbWVzc2FnZS5jb25maWcoewogICAgICAgICAgICAgICAgICB0b3A6IF9tZXNzYWdlVGlwcy50aXBzVG9wUG9zaXRpb24gfHwgIjI0cHgiLAogICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMiwKICAgICAgICAgICAgICAgICAgbWF4Q291bnQ6IDMKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIF90aGlzMTAuJG1lc3NhZ2VbIiIuY29uY2F0KF9tZXNzYWdlVGlwcy50aXBzVHlwZSldKHsKICAgICAgICAgICAgICAgICAgY29udGVudDogX21lc3NhZ2VUaXBzLnRpcHNEZXNjLAogICAgICAgICAgICAgICAgICBkdXJhdGlvbjogX21lc3NhZ2VUaXBzLnRpcHNUaW1lIHx8IDMKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIF90aCA9IF90aGlzMTA7CgogICAgICAgICAgICAgICAgaWYgKG5leHQpIHsKICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRMaXN0ID0gW107CgogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbmV4dCA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgICAgICAgICAgICAgIG5leHRMaXN0ID0gW25leHRdOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICBuZXh0TGlzdCA9IG5leHQ7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBuZXh0TGlzdC5mb3JFYWNoKGZ1bmN0aW9uICh2KSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGgubG9vcCh2LCBmbG93TWFwLCBwYXJhbXNBcnIpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9LCBfbWVzc2FnZVRpcHMudGlwc1RpbWUgKiAxMDAwKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU4KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgb3BlblBhZ2U6IGZ1bmN0aW9uIG9wZW5QYWdlKF9vcGVuUGFnZSkgewogICAgICB0aGlzLmdldFBhcmFtcyhfb3BlblBhZ2UpOwoKICAgICAgaWYgKF9vcGVuUGFnZS5ibGFuaykgewogICAgICAgIHZhciByb3V0ZVVybCA9IHRoaXMuJHJvdXRlci5yZXNvbHZlKHsKICAgICAgICAgIHBhdGg6ICIvcGFnZSIuY29uY2F0KF9vcGVuUGFnZS5wYWdlVXVpZCksCiAgICAgICAgICBxdWVyeTogX29iamVjdFNwcmVhZCh7fSwgdGhpcy5wYXJhbUpzb24pCiAgICAgICAgfSk7CiAgICAgICAgd2luZG93Lm9wZW4od2luZG93LmxvY2F0aW9uLm9yaWdpbiArIHJvdXRlVXJsLmhyZWYsICdfYmxhbmsnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICBwYXRoOiAiL3BhZ2UiLmNvbmNhdChfb3BlblBhZ2UucGFnZVV1aWQpLAogICAgICAgICAgcXVlcnk6IF9vYmplY3RTcHJlYWQoe30sIHRoaXMucGFyYW1Kc29uKQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgZGlhbG9nT3BlbjogZnVuY3Rpb24gZGlhbG9nT3BlbihfZGlhbG9nT3BlbiwgZmxvd01hcCwgcGFyYW1zQXJyLCBuZXh0KSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU5KCkgewogICAgICAgIHZhciBwcmltYXJ5S2V5VXVpZCwgcHJpbWFyeUtleUVuTmFtZSwgc3VicGFyYW1WYWx1ZSwgbmV4dExpc3Q7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHByaW1hcnlLZXlVdWlkID0gJyc7CiAgICAgICAgICAgICAgICBwcmltYXJ5S2V5RW5OYW1lID0gJyc7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTEudGFibGVJdGVtKSB7CiAgICAgICAgICAgICAgICAgIGlmIChfZGlhbG9nT3Blbi5zdWJwYXJhbVZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgc3VicGFyYW1WYWx1ZSA9IF9kaWFsb2dPcGVuLnN1YnBhcmFtVmFsdWU7CgogICAgICAgICAgICAgICAgICAgIGlmIChzdWJwYXJhbVZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICBwcmltYXJ5S2V5VXVpZCA9IF90aGlzMTEudGFibGVJdGVtW3N1YnBhcmFtVmFsdWVdOwogICAgICAgICAgICAgICAgICAgICAgcHJpbWFyeUtleUVuTmFtZSA9IHN1YnBhcmFtVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMxMS5kcmF3ZXJMaXN0LnB1c2goewogICAgICAgICAgICAgICAgICBjb250cm9sVXVpZDogInYiLmNvbmNhdChfZGlhbG9nT3Blbi5jb250cm9sVXVpZCksCiAgICAgICAgICAgICAgICAgIHByaW1hcnlLZXlVdWlkOiBwcmltYXJ5S2V5VXVpZCwKICAgICAgICAgICAgICAgICAgdGFibGVJdGVtOiBfdGhpczExLnRhYmxlSXRlbSwKICAgICAgICAgICAgICAgICAgcHJpbWFyeUtleUVuTmFtZTogcHJpbWFyeUtleUVuTmFtZQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKG5leHQpIHsKICAgICAgICAgICAgICAgICAgbmV4dExpc3QgPSBbXTsKCiAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbmV4dCA9PT0gInN0cmluZyIpIHsKICAgICAgICAgICAgICAgICAgICBuZXh0TGlzdCA9IFtuZXh0XTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBuZXh0TGlzdCA9IG5leHQ7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIG5leHRMaXN0LmZvckVhY2goZnVuY3Rpb24gKHYpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczExLmxvb3AodiwgZmxvd01hcCwgcGFyYW1zQXJyKTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIHNhdmVEYXRhOiBmdW5jdGlvbiBzYXZlRGF0YShfc2F2ZURhdGEsIGZsb3dNYXAsIHBhcmFtc0FyciwgbmV4dCkgewogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMCQoX2NvbnRleHQxMCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMCk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGRpYWxvZ0Nsb3NlOiBmdW5jdGlvbiBkaWFsb2dDbG9zZShfZGlhbG9nQ2xvc2UsIGZsb3dNYXAsIHBhcmFtc0FyciwgbmV4dCkgewogICAgICB2YXIgX3RoaXMxMiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTEoKSB7CiAgICAgICAgdmFyIGRyYXdlckxpc3Q7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDExLnByZXYgPSBfY29udGV4dDExLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBkcmF3ZXJMaXN0ID0gX3RoaXMxMi5kcmF3ZXJMaXN0LmZpbHRlcihmdW5jdGlvbiAodikgewogICAgICAgICAgICAgICAgICByZXR1cm4gdi5jb250cm9sVXVpZCAhPT0gInYiLmNvbmNhdChfZGlhbG9nQ2xvc2UuY29udHJvbFV1aWQpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBfdGhpczEyLmRyYXdlckxpc3QgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRyYXdlckxpc3QpKTsKCiAgICAgICAgICAgICAgICBfdGhpczEyLmdvTmV4dChuZXh0LCBmbG93TWFwLCBwYXJhbXNBcnIpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIG5vdGlmaWNhdGlvbnM6IGZ1bmN0aW9uIG5vdGlmaWNhdGlvbnMoX25vdGlmaWNhdGlvbnMsIGZsb3dNYXAsIHBhcmFtc0FyciwgbmV4dCkgewogICAgICB2YXIgX3RoaXMxMyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTIoKSB7CiAgICAgICAgdmFyIHBhcmFtcywgX3RoOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEyJChfY29udGV4dDEyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTIucHJldiA9IF9jb250ZXh0MTIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHBhcmFtcyA9IF9ub3RpZmljYXRpb25zLmljb25Td2l0Y2ggPyB7CiAgICAgICAgICAgICAgICAgIHBsYWNlbWVudDogX25vdGlmaWNhdGlvbnMubG9jYXRpb25UeXBlLAogICAgICAgICAgICAgICAgICBkdXJhdGlvbjogX25vdGlmaWNhdGlvbnMudGlwc1RpbWUgfHwgMywKICAgICAgICAgICAgICAgICAgaWNvbjogX25vdGlmaWNhdGlvbnMuaWNvblN3aXRjaCwKICAgICAgICAgICAgICAgICAgdG9wOiBfbm90aWZpY2F0aW9ucy50aXBzVG9wUG9zaXRpb24gfHwgJzIwcHgnCiAgICAgICAgICAgICAgICB9IDogewogICAgICAgICAgICAgICAgICBwbGFjZW1lbnQ6IF9ub3RpZmljYXRpb25zLmxvY2F0aW9uVHlwZSwKICAgICAgICAgICAgICAgICAgZHVyYXRpb246IF9ub3RpZmljYXRpb25zLnRpcHNUaW1lIHx8IDMsCiAgICAgICAgICAgICAgICAgIHRvcDogX25vdGlmaWNhdGlvbnMudGlwc1RvcFBvc2l0aW9uIHx8ICcyMHB4JwogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICBfdGhpczEzLiRub3RpZmljYXRpb24uY29uZmlnKHBhcmFtcyk7CgogICAgICAgICAgICAgICAgaWYgKF9ub3RpZmljYXRpb25zLmljb25Td2l0Y2gpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxMy4kbm90aWZpY2F0aW9uW19ub3RpZmljYXRpb25zLnRpcHNUeXBlXSh7CiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogX25vdGlmaWNhdGlvbnMudGlwc1RpdGxlLAogICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfbm90aWZpY2F0aW9ucy50aXBzRGVzYwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTMuJG5vdGlmaWNhdGlvbi5vcGVuKHsKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBfbm90aWZpY2F0aW9ucy50aXBzVGl0bGUsCiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IF9ub3RpZmljYXRpb25zLnRpcHNEZXNjCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aCA9IF90aGlzMTM7CgogICAgICAgICAgICAgICAgaWYgKG5leHQpIHsKICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRMaXN0ID0gW107CgogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbmV4dCA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgICAgICAgICAgICAgIG5leHRMaXN0ID0gW25leHRdOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICBuZXh0TGlzdCA9IG5leHQ7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBuZXh0TGlzdC5mb3JFYWNoKGZ1bmN0aW9uICh2KSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGgubG9vcCh2LCBmbG93TWFwLCBwYXJhbXNBcnIpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9LCBfbm90aWZpY2F0aW9ucy50aXBzVGltZSAqIDEwMDApOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGdldEZpbHRlclRhYmxlTGlzdDogZnVuY3Rpb24gZ2V0RmlsdGVyVGFibGVMaXN0KF9nZXRGaWx0ZXJUYWJsZUxpc3QsIGZsb3dNYXAsIHBhcmFtc0FyciwgbmV4dCkgewogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTMoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMyQoX2NvbnRleHQxMykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEzLnByZXYgPSBfY29udGV4dDEzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMyk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGVkaXRPYmplY3Q6IGZ1bmN0aW9uIGVkaXRPYmplY3QoX2VkaXRPYmplY3QsIGZsb3dNYXAsIHBhcmFtc0FyciwgbmV4dCkgewogICAgICB2YXIgX3RoaXMxNCA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTQoKSB7CiAgICAgICAgdmFyIHBhcmFtcywgZm9ybUlkczsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE0JChfY29udGV4dDE0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTQucHJldiA9IF9jb250ZXh0MTQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHBhcmFtcyA9IE9iamVjdC5hc3NpZ24oewogICAgICAgICAgICAgICAgICBhY3Rpb25UeXBlOiBfZWRpdE9iamVjdC5lZGl0VHlwZQogICAgICAgICAgICAgICAgfSwgX2RlZmluZVByb3BlcnR5KHt9LCBfZWRpdE9iamVjdC5lZGl0VHlwZSwgX2VkaXRPYmplY3RbX2VkaXRPYmplY3QuZWRpdFR5cGVdKSk7CgogICAgICAgICAgICAgICAgX3RoaXMxNFtwYXJhbXMuYWN0aW9uVHlwZV0ocGFyYW1zW3BhcmFtcy5hY3Rpb25UeXBlXSk7CgogICAgICAgICAgICAgICAgX3RoaXMxNC5wYWdlUXVlcnkucHJpbWFyeUlkID0gX3RoaXMxNC50YWJsZUl0ZW0uaWQ7CiAgICAgICAgICAgICAgICBfdGhpczE0LnBhZ2VRdWVyeS5wcmltYXJ5S2V5ID0gX2VkaXRPYmplY3QuZGlhbG9nT3Blbi5zdWJwYXJhbVZhbHVlOwogICAgICAgICAgICAgICAgZm9ybUlkcyA9IF9lZGl0T2JqZWN0LmRpYWxvZ09wZW4uZGF0YUZvcm1JZHM7CiAgICAgICAgICAgICAgICBmb3JtSWRzLmZvckVhY2goZnVuY3Rpb24gKHYpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxNFsiaW5pdEZvcm1EZXRhaWwiLmNvbmNhdCh2KV0oX2VkaXRPYmplY3QuZGlhbG9nT3Blbi5zdWJwYXJhbVZhbHVlKTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIF90aGlzMTQuZ29OZXh0KG5leHQsIGZsb3dNYXAsIHBhcmFtc0Fycik7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTE0KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgc2V0TG9va3VwVmFsdWU6IGZ1bmN0aW9uIHNldExvb2t1cFZhbHVlKF9zZXRMb29rdXBWYWx1ZSwgZmxvd01hcCwgcGFyYW1zQXJyLCBuZXh0KSB7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNSgpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE1JChfY29udGV4dDE1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTUucHJldiA9IF9jb250ZXh0MTUubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTE1KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgY29uZmlybTogZnVuY3Rpb24gY29uZmlybShfY29uZmlybSwgZmxvd01hcCwgcGFyYW1zQXJyLCBjaG9pY2VOZXh0KSB7CiAgICAgIHZhciBfdGggPSB0aGlzOwoKICAgICAgdGhpcy4kY29uZmlybSh7CiAgICAgICAgdGl0bGU6IF9jb25maXJtID09PSBudWxsIHx8IF9jb25maXJtID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY29uZmlybS50aXBzVGl0bGUsCiAgICAgICAgY29udGVudDogX2NvbmZpcm0gPT09IG51bGwgfHwgX2NvbmZpcm0gPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jb25maXJtLnRpcHNEZXNjLAogICAgICAgIG9rVGV4dDogIuehruiupCIsCiAgICAgICAgY2FuY2VsVGV4dDogIuWPlua2iCIsCiAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICBvbk9rOiBmdW5jdGlvbiBvbk9rKCkgewogICAgICAgICAgdmFyIG5leHQgPSBjaG9pY2VOZXh0ID09PSBudWxsIHx8IGNob2ljZU5leHQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNob2ljZU5leHQuZmluZChmdW5jdGlvbiAodikgewogICAgICAgICAgICByZXR1cm4gdi5pc1RydWU7CiAgICAgICAgICB9KS5OZXh0OwogICAgICAgICAgbmV4dCAmJiBuZXh0ICYmIF90aC5sb29wKG5leHQsIGZsb3dNYXAsIHBhcmFtc0Fycik7CiAgICAgICAgfSwKICAgICAgICBvbkNhbmNlbDogZnVuY3Rpb24gb25DYW5jZWwoKSB7CiAgICAgICAgICB2YXIgbmV4dCA9IGNob2ljZU5leHQgPT09IG51bGwgfHwgY2hvaWNlTmV4dCA9PT0gdm9pZCAwID8gdm9pZCAwIDogY2hvaWNlTmV4dC5maW5kKGZ1bmN0aW9uICh2KSB7CiAgICAgICAgICAgIHJldHVybiAhdi5pc1RydWU7CiAgICAgICAgICB9KS5OZXh0OwogICAgICAgICAgbmV4dCAmJiBuZXh0ICYmIF90aC5sb29wKG5leHQsIGZsb3dNYXAsIHBhcmFtc0Fycik7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICByZWZyZXNoRGF0YTogZnVuY3Rpb24gcmVmcmVzaERhdGEoX3JlZnJlc2hEYXRhLCBmbG93TWFwLCBwYXJhbXNBcnIsIG5leHQpIHsKICAgICAgdmFyIF90aGlzMTUgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE2KCkgewogICAgICAgIHZhciBfcmVmcmVzaERhdGEkY29udHJvbEw7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTYkKF9jb250ZXh0MTYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxNi5wcmV2ID0gX2NvbnRleHQxNi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3JlZnJlc2hEYXRhID09PSBudWxsIHx8IF9yZWZyZXNoRGF0YSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9yZWZyZXNoRGF0YSRjb250cm9sTCA9IF9yZWZyZXNoRGF0YS5jb250cm9sTGlzdCkgPT09IG51bGwgfHwgX3JlZnJlc2hEYXRhJGNvbnRyb2xMID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcmVmcmVzaERhdGEkY29udHJvbEwuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICBfdGhpczE1LnJlZnJlc2hEYXRhKGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBfdGhpczE1LmNvbnRyb2xQcm9wZXJ0aWVzWyJ2Ii5jb25jYXQoaXRlbSldLmRhdGFTb3VyY2VUeXBlOwoKICAgICAgICAgICAgICAgICAgdmFyIGJhc2V0eXBlID0gX3RoaXMxNS5jb250cm9sUHJvcGVydGllc1sidiIuY29uY2F0KGl0ZW0pXS50eXBlOwoKICAgICAgICAgICAgICAgICAgdmFyIHJlcSA9IF90aGlzMTUuY29udHJvbFByb3BlcnRpZXNbInYiLmNvbmNhdChpdGVtKV0ucmVxOwoKICAgICAgICAgICAgICAgICAgaWYgKFsnVHJlZScsICdUcmVlQ29udGFpbmVyJ10uaW5jbHVkZXMoYmFzZXR5cGUpKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxNVsiZ2V0RmlsdGVyVGFibGVMaXN0Ii5jb25jYXQoaXRlbSldKGl0ZW0pOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAnZmxvdycpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgU3lzdGVtX1BhZ2UgPSB7fTsKICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1zSnNvbiA9IEpTT04ucGFyc2UocmVxLnBhcmFtc0pzb24pOwogICAgICAgICAgICAgICAgICAgIHBhcmFtc0pzb24uZGF0YS5TeXN0ZW1fUGFnZSA9IFN5c3RlbV9QYWdlOwogICAgICAgICAgICAgICAgICAgIHJlcS5wYXJhbXNKc29uID0gSlNPTi5zdHJpbmdpZnkocGFyYW1zSnNvbik7CgogICAgICAgICAgICAgICAgICAgIF90aGlzMTUuJHBvc3QoIi9wcm9jZXNzL3YxLyIuY29uY2F0KHJlcS5wcm9jZXNzSnNvblVVaWQpLCByZXEpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdERhdGEgPSBfdGhpczE1WyJzZXRMb29rdXBWYWx1ZSIuY29uY2F0KGl0ZW0pXShyZXMuZGF0YVtyZXEuZmxvd3Jlc1BhcmFtc05hbWVdKTsKCiAgICAgICAgICAgICAgICAgICAgICBfdGhpczE1LmNvbnRyb2xQcm9wZXJ0aWVzWyJ2Ii5jb25jYXQoaXRlbSldLmRhdGFTb3VyY2VMaXN0ID0gcmVzdWx0RGF0YTsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzMTUuY29udHJvbFByb3BlcnRpZXNbInYiLmNvbmNhdChpdGVtKV0ucGFnaW5hdGlvbiA9IHJlcy5kYXRhW3JlcS5mbG93cmVzUGFyYW1zTmFtZV07CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2VudGl0eScpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgd2hlcmUgPSBfdGhpczE1LmNvbnRyb2xQcm9wZXJ0aWVzWyJ2Ii5jb25jYXQoaXRlbSldLndoZXJlUGFyYW1zOwoKICAgICAgICAgICAgICAgICAgICBfdGhpczE1LnNldFdoZXJlKHdoZXJlLndoZXJlKTsKCiAgICAgICAgICAgICAgICAgICAgX3RoaXMxNS4kcG9zdCgiL3Byb2Nlc3MvdjEvZGF0YWdyaWRRdWVyeSIsIHsKICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHdoZXJlCiAgICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgX3Jlc3VsdCRwYWdpbmF0aW9uOwoKICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSByZXMuZGF0YS5saXN0OwogICAgICAgICAgICAgICAgICAgICAgX3RoaXMxNS5jb250cm9sUHJvcGVydGllc1sidiIuY29uY2F0KGl0ZW0pXS5wYWdpbmF0aW9uID0gKF9yZXN1bHQkcGFnaW5hdGlvbiA9IHJlc3VsdC5wYWdpbmF0aW9uKSAhPT0gbnVsbCAmJiBfcmVzdWx0JHBhZ2luYXRpb24gIT09IHZvaWQgMCA/IF9yZXN1bHQkcGFnaW5hdGlvbiA6IHt9OwoKICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHREYXRhID0gX3RoaXMxNVsic2V0TG9va3VwVmFsdWUiLmNvbmNhdChpdGVtKV0ocmVzdWx0KTsKCiAgICAgICAgICAgICAgICAgICAgICBfdGhpczE1LmNvbnRyb2xQcm9wZXJ0aWVzWyJ2Ii5jb25jYXQoaXRlbSldLmRhdGFTb3VyY2VMaXN0ID0gcmVzdWx0RGF0YTsKCiAgICAgICAgICAgICAgICAgICAgICBfdGhpczE1WyJnZXRGaWx0ZXJUYWJsZUxpc3QiLmNvbmNhdChpdGVtKV0oaXRlbSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIF90aGlzMTUuZ29OZXh0KG5leHQsIGZsb3dNYXAsIHBhcmFtc0Fycik7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTYuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTE2KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgaGlkZUNvbnRyb2xzOiBmdW5jdGlvbiBoaWRlQ29udHJvbHMoX2hpZGVDb250cm9scywgZmxvd01hcCwgcGFyYW1zQXJyLCBuZXh0KSB7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNygpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE3JChfY29udGV4dDE3KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTcucHJldiA9IF9jb250ZXh0MTcubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTcuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTE3KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgc2V0Q29udHJvbFByb3BlcnRpZXM6IGZ1bmN0aW9uIHNldENvbnRyb2xQcm9wZXJ0aWVzKGVsZW1lbnQsIHJlcywgcGFyYW1zLCBwYXJhbXNBcnIpIHsKICAgICAgdmFyIF90aGlzMTYgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE4KCkgewogICAgICAgIHZhciB2YWx1ZSwgbGlzdCwgZGF0YWxpc3QsIHJlc3VsdERhdGEsIGZpZWxkSWQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxOCQoX2NvbnRleHQxOCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE4LnByZXYgPSBfY29udGV4dDE4Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IHJlczsKCiAgICAgICAgICAgICAgICBpZiAoIWVsZW1lbnQuY29udHJvbFV1aWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxOC5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmlzdGVtcGxhdGUpIHsKICAgICAgICAgICAgICAgICAgdmFsdWUgPSBfdGhpczE2LnRlbXBsYXRlKF90aGlzMTYuY29udHJvbFByb3BlcnRpZXNbInYiLmNvbmNhdChlbGVtZW50LmNvbnRyb2xVdWlkKV0sIF9kZWZpbmVQcm9wZXJ0eSh7fSwgZWxlbWVudC5wYXJhbXNOYW1lLCBkYXRhW2VsZW1lbnQucGFyYW1zTmFtZV0pKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5wYXJhbXNUeXBlID09PSAnTG9va3VwJykgewogICAgICAgICAgICAgICAgICBsaXN0ID0gcmVzLm1hcChmdW5jdGlvbiAodikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB2LmNvbHVtbnM7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB2YWx1ZSA9IHsKICAgICAgICAgICAgICAgICAgICByZXN1bHREYXRhOiBsaXN0CiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCEoZWxlbWVudC5iYXNlVHlwZSAmJiBbJ0xpc3QnLCAnTG9va3VwJ10uaW5jbHVkZXMoZWxlbWVudC5wYXJhbXNUeXBlKSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxOC5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuYmFzZVR5cGUgPT09ICdUYWcnKSB7CiAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnBhcmFtc1R5cGUgPT09ICdMb29rdXAnKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxNi5jb250cm9sUHJvcGVydGllc1sidiIuY29uY2F0KGVsZW1lbnQuY29udHJvbFV1aWQpXS52YWx1ZSA9IHZhbHVlW2VsZW1lbnQuc3ViRmllbGRJZF07CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgZGF0YWxpc3QgPSB2YWx1ZS5yZXN1bHREYXRhLm1hcChmdW5jdGlvbiAobSkgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uczogX29iamVjdFNwcmVhZCh7fSwgbSksCiAgICAgICAgICAgICAgICAgICAgICAgIHV1aWQ6IG0uaWQKICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxNi5jb250cm9sUHJvcGVydGllc1sidiIuY29uY2F0KGVsZW1lbnQuY29udHJvbFV1aWQpXS52YWx1ZSA9IGRhdGFsaXN0OwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBpZiAoIXZhbHVlLnJlc3VsdERhdGEpIHsKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHsKICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdERhdGE6IHZhbHVlCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgcmVzdWx0RGF0YSA9IF90aGlzMTZbInNldExvb2t1cFZhbHVlIi5jb25jYXQoZWxlbWVudC5jb250cm9sVXVpZCldKHZhbHVlKTsKICAgICAgICAgICAgICAgICAgX3RoaXMxNi5jb250cm9sUHJvcGVydGllc1sidiIuY29uY2F0KGVsZW1lbnQuY29udHJvbFV1aWQpXS5kYXRhU291cmNlTGlzdCA9IHJlc3VsdERhdGE7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQxOC5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgaWYgKCEoZWxlbWVudC5iYXNlVHlwZSAmJiBbJ1RhYmxlVmlldycsICdMaXN0VmlldycsICdDYXJkVmlldycsICdUYWJsZUNvbnRhaW5lciddLmluY2x1ZGVzKGVsZW1lbnQuYmFzZVR5cGUpICYmIGVsZW1lbnQuc3ViRmllbGRJZCAmJiBfdGhpczE2LnRhYmxlSXRlbSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxOC5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghKF90aGlzMTYuZGF0YUNvbnRyb2wuZGF0YUluZGV4ID4gLTEgJiYgX3RoaXMxNi5kYXRhQ29udHJvbC5hZHZhbmNlZFV1aWQpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTgubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBmaWVsZElkID0gZWxlbWVudC5zdWJGaWVsZElkOwoKICAgICAgICAgICAgICAgIGlmICghZmllbGRJZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDE4Lm5leHQgPSAxNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMxNi5jb250cm9sUHJvcGVydGllc1sidiIuY29uY2F0KGZpZWxkSWQpXS5kYXRhU291cmNlID0gdmFsdWU7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgX3RoaXMxNi5jb250cm9sUHJvcGVydGllc1sidiIuY29uY2F0KGVsZW1lbnQuY29udHJvbFV1aWQpXS52YWx1ZSA9IHZhbHVlOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgX3RoaXMxNi5jb250cm9sUHJvcGVydGllc1sidiIuY29uY2F0KGVsZW1lbnQuY29udHJvbFV1aWQpXS5yZXEgPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHBhcmFtcyksIHt9LCB7CiAgICAgICAgICAgICAgICAgIGZsb3dyZXNQYXJhbXNOYW1lOiBlbGVtZW50LnBhcmFtc05hbWUsCiAgICAgICAgICAgICAgICAgIGJlbG9uZzogZWxlbWVudC5iZWxvbmcsCiAgICAgICAgICAgICAgICAgIHR5cGU6ICdmbG93JwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5pc1ZhcmFibGUpIHsKICAgICAgICAgICAgICAgICAgaWYgKCFwYXJhbXNBcnIuZ2xvYmFsVmFyaWFibGVMaXN0KSBwYXJhbXNBcnIuZ2xvYmFsVmFyaWFibGVMaXN0ID0ge307CiAgICAgICAgICAgICAgICAgIHBhcmFtc0Fyci5nbG9iYWxWYXJpYWJsZUxpc3RbZWxlbWVudC5wYXJhbXNOYW1lXSA9IHZhbHVlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnBhcmFtc1R5cGUgIT09ICdMaXN0JyAmJiBlbGVtZW50LmNoaWxkcmVuICYmIGVsZW1lbnQuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICBlbGVtZW50LmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzICYmIHJlcy5oYXNPd25Qcm9wZXJ0eShpdGVtLnBhcmFtc05hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5wYXJhbXNUeXBlID09PSAnTG9va3VwJyAmJiAhaXRlbS5tdWx0aXBsZSAmJiByZXNbaXRlbS5wYXJhbXNOYW1lXSBpbnN0YW5jZW9mIEFycmF5ICYmIHJlc1tpdGVtLnBhcmFtc05hbWVdLmxlbmd0aCA9PT0gMSkgewogICAgICAgICAgICAgICAgICAgICAgICBfdGhpczE2LnNldENvbnRyb2xQcm9wZXJ0aWVzKGl0ZW0sIHJlc1tpdGVtLnBhcmFtc05hbWVdWzBdLmNvbHVtbnMsIHBhcmFtcywgcGFyYW1zQXJyKTsKICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMTYuc2V0Q29udHJvbFByb3BlcnRpZXMoaXRlbSwgcmVzW2l0ZW0ucGFyYW1zTmFtZV0sIHBhcmFtcywgcGFyYW1zQXJyKTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSAvLyDlop7liqDnlJ/miJB0b2tlbu+8jOWtmOWCqHRva2VuCgoKICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnBhcmFtc1R5cGUgPT09ICdUT0tFTicpIHsKICAgICAgICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgndG9rZW4nLCByZXMpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTgpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBnZXRQYXJhbXM6IGZ1bmN0aW9uIGdldFBhcmFtcyhvcGVuUGFnZSkgewogICAgICB2YXIgX3RoaXMxNyA9IHRoaXM7CgogICAgICB0aGlzLnBhcmFtSnNvbiA9IHt9OwogICAgICB2YXIgcGFyYW1lTGlzdCA9IG9wZW5QYWdlLnBhcmFtZUxpc3Q7CiAgICAgIHBhcmFtZUxpc3QuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIGlmIChpdGVtLnBhcmFtTmFtZSA9PT0gJ19lZGl0T2JqZWN0aWRfJykgewogICAgICAgICAgX3RoaXMxNy5wYXJhbUpzb25bJ19lZGl0T2JqZWN0UHJpbWFyeUtleV8nXSA9IF90aGlzMTcucGFyYW1Kc29uWydfZWRpdE9iamVjdFByaW1hcnlLZXlfJ10gfHwgaXRlbS5zdWJwYXJhbVZhbHVlOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMxNy5wYXJhbUpzb25baXRlbS5wYXJhbU5hbWVdID0gX3RoaXMxNy5nZXRQYXJhbVVybChpdGVtKTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0UGFyYW1Vcmw6IGZ1bmN0aW9uIGdldFBhcmFtVXJsKGl0ZW0pIHsKICAgICAgaWYgKGl0ZW0ucGFyYW1Tb3VyY2UgPT09ICd1cmwnKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJHJvdXRlLnF1ZXJ5W2l0ZW0uZmllbGRwYXJhbU5hbWVdOwogICAgICB9IGVsc2UgaWYgKGl0ZW0uc3VicGFyYW1WYWx1ZSkgewogICAgICAgIHJldHVybiB0aGlzLmdldHRhYmxlSXRlbShpdGVtLnN1YnBhcmFtVmFsdWUpOwogICAgICB9IGVsc2UgaWYgKGl0ZW0ucGFyYW1Tb3VyY2UgPT09ICdjdXJzb3JtJykgewogICAgICAgIHJldHVybiBpdGVtLmN1cnNvcm1WYWx1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy5jb250cm9sUHJvcGVydGllc1sidiIuY29uY2F0KGl0ZW0uY29udHJvbFV1aWQpXS52YWx1ZTsKICAgICAgfQogICAgfQogIH0sIF9kZWZpbmVQcm9wZXJ0eShfbWV0aG9kcywgImRpYWxvZ09wZW4iLCBmdW5jdGlvbiBkaWFsb2dPcGVuKF9kaWFsb2dPcGVuMiwgZmxvd01hcCwgcGFyYW1zQXJyLCBuZXh0KSB7CiAgICB2YXIgX3RoaXMxOCA9IHRoaXM7CgogICAgdmFyIHByaW1hcnlLZXlVdWlkID0gJyc7CiAgICB2YXIgcHJpbWFyeUtleUVuTmFtZSA9ICcnOwoKICAgIGlmICh0aGlzLnRhYmxlSXRlbSkgewogICAgICBpZiAoX2RpYWxvZ09wZW4yLnN1YnBhcmFtVmFsdWUpIHsKICAgICAgICB2YXIgc3VicGFyYW1WYWx1ZSA9IF9kaWFsb2dPcGVuMi5zdWJwYXJhbVZhbHVlOwoKICAgICAgICBpZiAoc3VicGFyYW1WYWx1ZSkgewogICAgICAgICAgcHJpbWFyeUtleVV1aWQgPSB0aGlzLnRhYmxlSXRlbVtzdWJwYXJhbVZhbHVlXTsKICAgICAgICAgIHByaW1hcnlLZXlFbk5hbWUgPSBzdWJwYXJhbVZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHRoaXMuZHJhd2VyTGlzdC5wdXNoKHsKICAgICAgY29udHJvbFV1aWQ6ICJ2Ii5jb25jYXQoX2RpYWxvZ09wZW4yLmNvbnRyb2xVdWlkKSwKICAgICAgcHJpbWFyeUtleVV1aWQ6IHByaW1hcnlLZXlVdWlkLAogICAgICB0YWJsZUl0ZW06IHRoaXMudGFibGVJdGVtLAogICAgICBwcmltYXJ5S2V5RW5OYW1lOiBwcmltYXJ5S2V5RW5OYW1lCiAgICB9KTsKCiAgICBpZiAobmV4dCkgewogICAgICB2YXIgbmV4dExpc3QgPSBbXTsKCiAgICAgIGlmICh0eXBlb2YgbmV4dCA9PT0gInN0cmluZyIpIHsKICAgICAgICBuZXh0TGlzdCA9IFtuZXh0XTsKICAgICAgfSBlbHNlIHsKICAgICAgICBuZXh0TGlzdCA9IG5leHQ7CiAgICAgIH0KCiAgICAgIG5leHRMaXN0LmZvckVhY2goZnVuY3Rpb24gKHYpIHsKICAgICAgICBfdGhpczE4Lmxvb3AodiwgZmxvd01hcCwgcGFyYW1zQXJyKTsKICAgICAgfSk7CiAgICB9CiAgfSksIF9kZWZpbmVQcm9wZXJ0eShfbWV0aG9kcywgImdldHRhYmxlSXRlbSIsIGZ1bmN0aW9uIGdldHRhYmxlSXRlbShzdWJpdGVtKSB7CiAgICByZXR1cm4gdGhpcy50YWJsZUl0ZW1bc3ViaXRlbV07CiAgfSksIF9kZWZpbmVQcm9wZXJ0eShfbWV0aG9kcywgImdldExvb2t1cERhdGEiLCBmdW5jdGlvbiBnZXRMb29rdXBEYXRhKGxvb2t1cElkTGlzdCwgbGlzdCkgewogICAgdmFyIF90aGlzMTkgPSB0aGlzOwoKICAgIHZhciBfbG9va3VwSWRMaXN0ID0gX3RvQXJyYXkobG9va3VwSWRMaXN0KSwKICAgICAgICBsb29rdXBJZCA9IF9sb29rdXBJZExpc3RbMF0sCiAgICAgICAgbG9va3VwTGlzdCA9IF9sb29rdXBJZExpc3Quc2xpY2UoMSk7CgogICAgdmFyIHJlc3VsdCA9IFtdOwogICAgaWYgKGxpc3QgaW5zdGFuY2VvZiBBcnJheSkgbGlzdC5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgaWYgKGxvb2t1cExpc3QubGVuZ3RoKSB7CiAgICAgICAgcmVzdWx0LnB1c2goX3RoaXMxOS5nZXRMb29rdXBEYXRhKGxvb2t1cExpc3QsIGl0ZW0uY29sdW1uc1tsb29rdXBJZF0pKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoaXRlbS5jb2x1bW5zW2xvb2t1cElkXSBpbnN0YW5jZW9mIE9iamVjdCkgewogICAgICAgICAgcmVzdWx0LnB1c2goaXRlbS5jb2x1bW5zW2xvb2t1cElkXS5maWVsZHMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHQucHVzaChpdGVtLmNvbHVtbnNbbG9va3VwSWRdKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIHJlc3VsdC5qb2luKCcsJyk7CiAgfSksIF9kZWZpbmVQcm9wZXJ0eShfbWV0aG9kcywgImdldExvb2t1cExpc3QiLCBmdW5jdGlvbiBnZXRMb29rdXBMaXN0KGxpc3QpIHsKICAgIGlmIChsaXN0IGluc3RhbmNlb2YgQXJyYXkpIHsKICAgICAgdmFyIHJlc3VsdCA9IFtdOwogICAgICByZXN1bHQgPSBsaXN0Lm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLnV1aWQ7CiAgICAgIH0pOwogICAgICByZXR1cm4gcmVzdWx0LmpvaW4oJywnKTsKICAgIH0KCiAgICByZXR1cm4gbGlzdDsKICB9KSwgX2RlZmluZVByb3BlcnR5KF9tZXRob2RzLCAibG9vcCIsIGZ1bmN0aW9uIGxvb3Aoc3RhcnQsIGZsb3dNYXAsIHBhcmFtc0FycikgewogICAgdmFyIF9mbG93TWFwJHN0YXJ0LAogICAgICAgIF9mbG93TWFwJHN0YXJ0MiwKICAgICAgICBfZmxvd01hcCRzdGFydDMsCiAgICAgICAgX3RoaXMyMCA9IHRoaXM7CgogICAgdmFyIGFjdGlvblR5cGUgPSAoX2Zsb3dNYXAkc3RhcnQgPSBmbG93TWFwW3N0YXJ0XSkgPT09IG51bGwgfHwgX2Zsb3dNYXAkc3RhcnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9mbG93TWFwJHN0YXJ0LmFjdGlvblR5cGU7CiAgICB2YXIgY3VycmVudCA9IChfZmxvd01hcCRzdGFydDIgPSBmbG93TWFwW3N0YXJ0XSkgPT09IG51bGwgfHwgX2Zsb3dNYXAkc3RhcnQyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZmxvd01hcCRzdGFydDIuY3VycmVudDsKICAgIHZhciBOZXh0ID0gKF9mbG93TWFwJHN0YXJ0MyA9IGZsb3dNYXBbc3RhcnRdKSA9PT0gbnVsbCB8fCBfZmxvd01hcCRzdGFydDMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9mbG93TWFwJHN0YXJ0My5OZXh0OwoKICAgIGlmIChhY3Rpb25UeXBlID09PSAiY2hvaWNlIikgewogICAgICBhY3Rpb25UeXBlICYmIHRoaXNbYWN0aW9uVHlwZV0ocGFyYW1zQXJyW2N1cnJlbnRdLCBmbG93TWFwLCBwYXJhbXNBcnIsIGZsb3dNYXBbc3RhcnRdLmNob2ljZU5leHQsIHBhcmFtc0FyciA9PT0gbnVsbCB8fCBwYXJhbXNBcnIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBhcmFtc0Fyci5nbG9iYWxWYXJpYWJsZUxpc3QpOwogICAgfSBlbHNlIGlmIChhY3Rpb25UeXBlID09PSAiY2hvb3NlIikgewogICAgICBhY3Rpb25UeXBlICYmIHRoaXNbYWN0aW9uVHlwZV0ocGFyYW1zQXJyW2N1cnJlbnRdLCBmbG93TWFwLCBwYXJhbXNBcnIsIHBhcmFtc0FyciA9PT0gbnVsbCB8fCBwYXJhbXNBcnIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBhcmFtc0Fyci5nbG9iYWxWYXJpYWJsZUxpc3QpOwogICAgfSBlbHNlIGlmIChhY3Rpb25UeXBlID09PSAiY29uZmlybSIpIHsKICAgICAgYWN0aW9uVHlwZSAmJiB0aGlzW2FjdGlvblR5cGVdKHBhcmFtc0FycltjdXJyZW50XSwgZmxvd01hcCwgcGFyYW1zQXJyLCBmbG93TWFwW3N0YXJ0XS5jaG9pY2VOZXh0KTsKICAgIH0gZWxzZSBpZiAoKGFjdGlvblR5cGUgPT09ICdzYXZlRGF0YScgfHwgYWN0aW9uVHlwZSA9PT0gJ2RlbGV0ZU9iamVjdCcpICYmIGN1cnJlbnQpIHsKICAgICAgdGhpc1tjdXJyZW50XSgpOwoKICAgICAgaWYgKE5leHQpIHsKICAgICAgICB2YXIgbmV4dExpc3QgPSBbXTsKCiAgICAgICAgaWYgKHR5cGVvZiBOZXh0ID09PSAic3RyaW5nIikgewogICAgICAgICAgbmV4dExpc3QgPSBbTmV4dF07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG5leHRMaXN0ID0gTmV4dDsKICAgICAgICB9CgogICAgICAgIG5leHRMaXN0LmZvckVhY2goZnVuY3Rpb24gKHYpIHsKICAgICAgICAgIF90aGlzMjAubG9vcCh2LCBmbG93TWFwLCBwYXJhbXNBcnIpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGFjdGlvblR5cGUgPT09ICJpbnZva2VGbG93IikgewogICAgICB2YXIgX2Zsb3dNYXAkc3RhcnQ0OwoKICAgICAgYWN0aW9uVHlwZSAmJiB0aGlzW2FjdGlvblR5cGVdKHBhcmFtc0FycltjdXJyZW50XSwgZmxvd01hcCwgcGFyYW1zQXJyLCAoX2Zsb3dNYXAkc3RhcnQ0ID0gZmxvd01hcFtzdGFydF0pID09PSBudWxsIHx8IF9mbG93TWFwJHN0YXJ0NCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Zsb3dNYXAkc3RhcnQ0Lmludm9rZUZsb3dOZXh0KTsKICAgIH0gZWxzZSB7CiAgICAgIGFjdGlvblR5cGUgJiYgdGhpc1thY3Rpb25UeXBlXShwYXJhbXNBcnJbY3VycmVudF0sIGZsb3dNYXAsIHBhcmFtc0FyciwgTmV4dCk7CiAgICB9CiAgfSksIF9kZWZpbmVQcm9wZXJ0eShfbWV0aG9kcywgInRlbXBsYXRlIiwgZnVuY3Rpb24gdGVtcGxhdGUoc3RyLCBvKSB7CiAgICB2YXIgcmUgPSAveyguKz8pfS9nOwogICAgcmV0dXJuIHN0ci5yZXBsYWNlKHJlLCBmdW5jdGlvbiAobWF0Y2gsIG5hbWUpIHsKICAgICAgcmV0dXJuIG9bbmFtZV0gPT09IHVuZGVmaW5lZCA/ICJ7Ii5jb25jYXQobmFtZSwgIn0iKSA6IG9bbmFtZV07CiAgICB9KTsKICB9KSwgX2RlZmluZVByb3BlcnR5KF9tZXRob2RzLCAiZ2V0VmFsIiwgZnVuY3Rpb24gZ2V0VmFsKG9iaiwgZ2xvYmFsVmFyaWFibGVMaXN0LCAkc2NvcGVkKSB7CiAgICB2YXIgX3RoaXMyMSA9IHRoaXM7CgogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE5KCkgewogICAgICB2YXIgdmFsdWUsIHZhbCwgdiwgaSwgX3ZhbCwgcmVzLCBpdGVtLCBfZGF0YSwgdmFsTGlzdCwgX3JlczIsIF9kYXRhMjsKCiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTkkKF9jb250ZXh0MTkpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDE5LnByZXYgPSBfY29udGV4dDE5Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHZhbHVlID0gJyc7CgogICAgICAgICAgICAgIGlmICghKG9iai5zb3VyY2UgPT09ICdjdXN0b21TZXRWYWx1ZScpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDE5Lm5leHQgPSAyNDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKCEob2JqLnZhbHVlVmFyaWFibGVMaXN0ICYmIG9iai52YWx1ZVZhcmlhYmxlTGlzdC5sZW5ndGggPiAwKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQxOS5uZXh0ID0gMjE7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmICghb2JqLnZhbHVlVmFyaWFibGVMaXN0T2JqKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDE5Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQxOS5uZXh0ID0gNjsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyMS5nZXRWYWwob2JqLnZhbHVlVmFyaWFibGVMaXN0T2JqLCBnbG9iYWxWYXJpYWJsZUxpc3QpOwoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIHZhbCA9IF9jb250ZXh0MTkuc2VudDsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOS5hYnJ1cHQoInJldHVybiIsIF90aGlzMjEudGVtcGxhdGUob2JqLnZhbHVlLCBfZGVmaW5lUHJvcGVydHkoe30sIG9iai52YWx1ZVZhcmlhYmxlTGlzdC5qb2luKCcvJyksIHZhbCkpKTsKCiAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgdiA9IG9iai52YWx1ZTsKICAgICAgICAgICAgICBpID0gMDsKCiAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgaWYgKCEoaSA8IG9iai52YWx1ZVZhcmlhYmxlTGlzdC5sZW5ndGgpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDE5Lm5leHQgPSAyMDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQxOS5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMjEuZ2V0VmFsKG9iai52YWx1ZVZhcmlhYmxlTGlzdFtpXSwgZ2xvYmFsVmFyaWFibGVMaXN0KTsKCiAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgX3ZhbCA9IF9jb250ZXh0MTkuc2VudDsKICAgICAgICAgICAgICB2ID0gX3RoaXMyMS50ZW1wbGF0ZSh2LCBfZGVmaW5lUHJvcGVydHkoe30sIG9iai52YWx1ZVZhcmlhYmxlTGlzdFtpXS52YWx1ZUxpc3Quam9pbignLycpLCBfdmFsKSk7CgogICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgICBfY29udGV4dDE5Lm5leHQgPSAxMjsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTkuYWJydXB0KCJyZXR1cm4iLCB2KTsKCiAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTkuYWJydXB0KCJyZXR1cm4iLCBvYmoudmFsdWUpOwoKICAgICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgICBpZiAoIShvYmouc291cmNlID09PSAnY29udHJvbFZhbHVlJykpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTkubmV4dCA9IDI4OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOS5hYnJ1cHQoInJldHVybiIsIF90aGlzMjEuZ2V0Q29udHJvbEZsb3dWYWwob2JqLmNvbnRyb2xVdWlkKSk7CgogICAgICAgICAgICBjYXNlIDI4OgogICAgICAgICAgICAgIGlmICghKG9iai5zb3VyY2UgPT09ICdnbG9iYWxWYWx1ZScpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDE5Lm5leHQgPSAzNjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQxOS5uZXh0ID0gMzE7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMjEuJGdldCgnL3Byb2Nlc3MvdjEvcXVlcnlHbG9iYWxWYWx1ZUJ5S2V5JywgewogICAgICAgICAgICAgICAgZmllbGROYW1lS2V5OiBvYmouZ2xvYmFsVmFsdWUKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMzE6CiAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQxOS5zZW50OwogICAgICAgICAgICAgIHZhbHVlID0gcmVzLmRhdGEuZmllbGROYW1lVmFsdWU7CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTkuYWJydXB0KCJyZXR1cm4iLCB2YWx1ZSk7CgogICAgICAgICAgICBjYXNlIDM2OgogICAgICAgICAgICAgIGlmICghKG9iai5zb3VyY2UgPT09ICd1cmwnIHx8IG9iai5zb3VyY2UgPT09ICd1cmxTZXRWYWx1ZScpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDE5Lm5leHQgPSA0MDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTkuYWJydXB0KCJyZXR1cm4iLCBfdGhpczIxLiRyb3V0ZS5xdWVyeVtvYmoucGFnZXBhcmFtc10gfHwgJycpOwoKICAgICAgICAgICAgY2FzZSA0MDoKICAgICAgICAgICAgICBpZiAoIShvYmouc291cmNlID09PSAnZ2xvYmFsVmFyaWFibGVWYWx1ZScpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDE5Lm5leHQgPSA0NDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTkuYWJydXB0KCJyZXR1cm4iLCBnbG9iYWxWYXJpYWJsZUxpc3Rbb2JqLmdsb2JhbFZhcmlhYmxlVmFsdWVdKTsKCiAgICAgICAgICAgIGNhc2UgNDQ6CiAgICAgICAgICAgICAgaWYgKCEob2JqLnNvdXJjZSA9PT0gJ3Byb3BlcnR5JyAmJiAoJHNjb3BlZCB8fCBfdGhpczIxLnRhYmxlSXRlbSkpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDE5Lm5leHQgPSA1NTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgLy/nu4Tku7blsZ7mgKcKICAgICAgICAgICAgICBpdGVtID0gJHNjb3BlZCB8fCBfdGhpczIxLnRhYmxlSXRlbTsKCiAgICAgICAgICAgICAgaWYgKCFvYmoub3B0aW9uUHJvcGVydHkpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTkubmV4dCA9IDUyOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfZGF0YSA9IGl0ZW1bb2JqLmZpZWxkSWRdOwogICAgICAgICAgICAgIHZhbExpc3QgPSBfZGF0YS5maWVsZHMubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICB2YXIgdmFsID0gSlNPTi5wYXJzZShpdGVtLmRhdGEpOwogICAgICAgICAgICAgICAgcmV0dXJuIHZhbFtvYmoub3B0aW9uUHJvcGVydHldOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE5LmFicnVwdCgicmV0dXJuIiwgdmFsTGlzdC5qb2luKCcvJykpOwoKICAgICAgICAgICAgY2FzZSA1MjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOS5hYnJ1cHQoInJldHVybiIsIGl0ZW1bb2JqLmZpZWxkSWRdKTsKCiAgICAgICAgICAgIGNhc2UgNTM6CiAgICAgICAgICAgICAgX2NvbnRleHQxOS5uZXh0ID0gNjc7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDU1OgogICAgICAgICAgICAgIGlmICghKG9iai5zb3VyY2UgPT09ICdkYXRhU2V0JykpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTkubmV4dCA9IDY3OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfcmVzMiA9IHt9OwoKICAgICAgICAgICAgICBpZiAoIV90aGlzMjEub3B0aW9uW29iai5vcHRpb25TZXRFbk5hbWVdKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDE5Lm5leHQgPSA2MTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX3JlczIgPSBfdGhpczIxLm9wdGlvbltvYmoub3B0aW9uU2V0RW5OYW1lXTsKICAgICAgICAgICAgICBfY29udGV4dDE5Lm5leHQgPSA2NTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgNjE6CiAgICAgICAgICAgICAgX2NvbnRleHQxOS5uZXh0ID0gNjM7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMjEuJGdldCgnL2RhbS92MS93bG9zT3B0aW9uRGF0YS9ub1BhZ2UvbGlzdCcsIHsKICAgICAgICAgICAgICAgIG9wdGlvblV1aWQ6IG9iai5vcHRpb25TZXRFbk5hbWUKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgNjM6CiAgICAgICAgICAgICAgX3JlczIgPSBfY29udGV4dDE5LnNlbnQ7CgogICAgICAgICAgICAgIF90aGlzMjEuJHNldChfdGhpczIxLm9wdGlvbiwgb2JqLm9wdGlvblNldEVuTmFtZSwgX3JlczIpOwoKICAgICAgICAgICAgY2FzZSA2NToKICAgICAgICAgICAgICBfZGF0YTIgPSBfcmVzMi5kYXRhLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoaXRlbS5kYXRhKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOS5hYnJ1cHQoInJldHVybiIsIF9kYXRhMi5maW5kKGZ1bmN0aW9uICh2KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gb2JqLm9wdGlvbkRhdGFJZCA9PT0gdi5pZDsKICAgICAgICAgICAgICB9KVtvYmoub3B0aW9uUHJvcGVydHldKTsKCiAgICAgICAgICAgIGNhc2UgNjc6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTkuYWJydXB0KCJyZXR1cm4iLCAnJyk7CgogICAgICAgICAgICBjYXNlIDY4OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE5LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUxOSk7CiAgICB9KSkoKTsKICB9KSwgX2RlZmluZVByb3BlcnR5KF9tZXRob2RzLCAiZ2V0VmFsVjIiLCBmdW5jdGlvbiBnZXRWYWxWMihjb25zdFZhbCwgJHNjb3BlZCkgewogICAgdmFyIF90aGlzMjIgPSB0aGlzOwoKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyMCgpIHsKICAgICAgdmFyIGNvbnRyb2xzLCBwcm9wZXJ0aWVzOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIwJChfY29udGV4dDIwKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyMC5wcmV2ID0gX2NvbnRleHQyMC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBpZiAoIShjb25zdFZhbFswXS5jbGFzc2lmaWNhdGlvbiA9PT0gJ2NvbnRyb2xzR3JvdXAnKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQyMC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29udHJvbHMgPSAoY29uc3RWYWwuZmluZChmdW5jdGlvbiAodikgewogICAgICAgICAgICAgICAgcmV0dXJuIHYuY2xhc3NpZmljYXRpb24gPT09ICdjb250cm9scyc7CiAgICAgICAgICAgICAgfSkgfHwge30pLmRhdGFLZXk7CiAgICAgICAgICAgICAgcHJvcGVydGllcyA9IChjb25zdFZhbC5maW5kKGZ1bmN0aW9uICh2KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdi5jbGFzc2lmaWNhdGlvbiA9PT0gJ3Byb3BlcnRpZXMnOwogICAgICAgICAgICAgIH0pIHx8IHt9KS5kYXRhS2V5OwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIwLmFicnVwdCgicmV0dXJuIiwgX3RoaXMyMi5jb250cm9sUHJvcGVydGllc1sidiIuY29uY2F0KGNvbnRyb2xzKV1bcHJvcGVydGllc10pOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIwLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUyMCk7CiAgICB9KSkoKTsKICB9KSwgX2RlZmluZVByb3BlcnR5KF9tZXRob2RzLCAiZ29OZXh0IiwgZnVuY3Rpb24gZ29OZXh0KG5leHQsIGZsb3dNYXAsIHBhcmFtc0FycikgewogICAgdmFyIF90aGlzMjMgPSB0aGlzOwoKICAgIGlmIChuZXh0KSB7CiAgICAgIHZhciBuZXh0TGlzdCA9IFtdOwoKICAgICAgaWYgKHR5cGVvZiBuZXh0ID09PSAnc3RyaW5nJykgewogICAgICAgIG5leHRMaXN0ID0gW25leHRdOwogICAgICB9IGVsc2UgewogICAgICAgIG5leHRMaXN0ID0gbmV4dDsKICAgICAgfQoKICAgICAgbmV4dExpc3QuZm9yRWFjaChmdW5jdGlvbiAodikgewogICAgICAgIF90aGlzMjMubG9vcCh2LCBmbG93TWFwLCBwYXJhbXNBcnIpOwogICAgICB9KTsKICAgIH0KICB9KSwgX21ldGhvZHMpLAogIGJlZm9yZURlc3Ryb3k6IGZ1bmN0aW9uIGJlZm9yZURlc3Ryb3koKSB7CiAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpOwogIH0KfTs="},{"version":3,"sources":["/node/src/code-factory/lsrkyyezwbvy/src/mixins/action.js"],"names":["data","paramJson","globalVariableList","timer","option","computed","isWeb","document","body","clientWidth","isH5","customStyle","uuid","classStyle","obj","classNames","JSON","parse","stringify","controlProperties","className","pcClass","reverse","forEach","item","mClass","methods","validate","list","validateList","getValidateList","$children","filter","includes","prop","flag","length","tiggerValidate","resultList","$options","name","push","setControlVal","val","baseType","type","value","map","join","e","title","showFn","status","$scoped","defaultFlag","display","console","log","conditionJudge","displayCondition","jude","$set","getControlFlowVal","controlUuid","element","children","getFormListInsertData","insertContent","valList","valItem","insert","sItem","paramsName","ids","dataSourceList","v","find","m","id","keyItem","subControlUuid","control","dataProperty","showRowSelection","selectList","resultData","controlValues","setWhere","where","or","orItem","and","andItem","south","controls","right","$route","query","pageparams","table_uuid","whereParams","model_uuid","orList","str","j","andStr","i","getVal","beforeMatchType","v1","afterMatchType","v2","matchType","jsStr","eval","start","flowMap","paramsArr","next","setValue","setValueList","source","actionType","tableItem","controlTargetUuid","goNext","delayThe","th","delayNumber","delayType","num","setTimeout","initFormDetail","invokeFlow","invokeFlowNext","req","res","processId","formData","system_pb","fieldparamName","$get","fieldNameKey","fieldNameValue","globalVariableValue","params","processJsonUUid","paramsJson","response","paramsType","$postGetfile","responseType","getResponse","blob","reader","FileReader","readAsDataURL","onload","a","createElement","download","decodeURI","headers","split","href","target","result","appendChild","click","removeChild","$post","resresultType","system_returnBelong","resresult","setControlProperties","resBelongid","Next","loop","actionNext","messageTips","$message","config","top","tipsTopPosition","duration","maxCount","tipsType","content","tipsDesc","tipsTime","_th","nextList","openPage","getParams","blank","routeUrl","$router","resolve","path","pageUuid","window","open","location","origin","dialogOpen","primaryKeyUuid","primaryKeyEnName","subparamValue","drawerList","saveData","dialogClose","notifications","iconSwitch","placement","locationType","icon","$notification","message","tipsTitle","description","getFilterTableList","editObject","Object","assign","editType","pageQuery","primaryId","primaryKey","formIds","dataFormIds","setLookupValue","confirm","choiceNext","$confirm","okText","cancelText","visible","onOk","isTrue","onCancel","refreshData","controlList","dataSourceType","basetype","System_Page","then","flowresParamsName","pagination","hideControls","istemplate","template","columns","subFieldId","datalist","dataControl","dataIndex","advancedUuid","fieldId","dataSource","belong","isVarable","hasOwnProperty","multiple","Array","sessionStorage","setItem","parameList","paramName","getParamUrl","paramSource","gettableItem","cursormValue","subitem","lookupIdList","lookupId","lookupList","getLookupData","fields","current","o","re","replace","match","undefined","valueVariableList","valueVariableListObj","valueList","globalValue","optionProperty","optionSetEnName","optionUuid","optionDataId","constVal","classification","dataKey","properties","beforeDestroy","clearInterval"],"mappings":"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","sourcesContent":["export default {\n    data(){\n        return {\n            paramJson: {},\n            globalVariableList: {},\n            timer: null,\n            option: {},\n        }\n    },\n    computed:{\n        isWeb(){\n            return document.body.clientWidth >= 750\n        },\n         isH5(){\n            return  750 > document.body.clientWidth\n        },\n        customStyle(){\n            return uuid => this.isWeb ? `PC${uuid}` : `H5${uuid}`\n        },\n        classStyle() {\n            return (uuid) => {\n                const obj = {}\n                const classNames = JSON.parse(JSON.stringify(this.controlProperties[uuid].className))\n                if (this.isWeb) {\n                classNames.pcClass.reverse().forEach((item) => {\n                    obj[item] = true\n                })\n                } else {\n                classNames.mClass.reverse().forEach((item) => {\n                    obj[item] = true\n                })\n                }\n                return obj\n            }\n        },\n\n    },\n    methods: {\n        /* 校验\n         * @param {Array} list 需要校验的控件\n         */\n        validate(list = []) {\n            const validateList = this.getValidateList(this.$children).filter(item => list.includes(item.prop))\n            let flag = true\n            if(validateList.length){\n                 validateList.forEach((item) =>{\n                    if(!item.tiggerValidate()){\n                        flag = false\n                    }\n                 }\n                )\n            }\n            return flag;\n        },\n        getValidateList(list) {\n            const resultList = [];\n            list.forEach((item) => {\n                if (item.$options.name === \"validate\") {\n                    resultList.push(item);\n                }\n                if (item.$children && item.$children.length) {\n                    resultList.push(...this.getValidateList(item.$children));\n                }\n            });\n            return resultList;\n        },\n        setControlVal(val,baseType,type){\n            if(type==='Address' && baseType!=='Address'){\n               try{\n                    const value=typeof val ==='string'?JSON.parse(val):val\n                    return value.map((item) => item.name).join(\"/\");\n                }catch(e){\n                    return '';\n                }\n            };\n             if(type==='File' && baseType!=='FileUpload'){\n               try{\n                    const value=typeof val ==='string'?JSON.parse(val):val\n                    return value.map((item) => item.title).join(\"/\");\n                }catch(e){\n                    return '';\n                }\n            };\n            return val\n        },\n           async showFn(status, $scoped,uuid) {\n               const defaultFlag=status.display==='show'\n\n                console.log(status, $scoped)\n                const jude = await this.conditionJudge(status.displayCondition, null,$scoped)\n                \n                  const flag = defaultFlag ? !(jude && defaultFlag) : defaultFlag || jude\n                $scoped[`display${uuid}`] =flag\n                this.$set($scoped, { [`display${uuid}`]: flag })\n            },\n        getControlFlowVal(controlUuid, element) {\n            let value = this.controlProperties[`v${controlUuid}`].value;\n            let type = this.controlProperties[`v${controlUuid}`]?.type;\n            if (\n                type &&\n                [\n                    \"Video\",\n                    \"Audio\",\n                    \"FileUpload\",\n                ].includes(type)\n            ) {\n                value = typeof this.controlProperties[`v${controlUuid}`].value === 'string' ? JSON.parse(this.controlProperties[`v${controlUuid}`].value) : this.controlProperties[`v${controlUuid}`].value;\n            } else if (controlUuid && ['TableView', 'CardView', 'ListView', 'TableContainer', 'FormList'].includes(type)) {\n                if (element?.children?.length > 0) {\n                    //有子集\n                    if (['FormList'].includes(type)) {\n                        let list = this.getFormListInsertData(controlUuid).insertContent\n                        let valList = [];\n                        list.forEach(valItem => {\n                            const obj = {};\n                            valItem.insert.forEach(sItem => {\n                                element.children.forEach(item => {\n                                    const paramsName = item.paramsName;\n                                    obj[paramsName] = sItem.value;\n                                });\n                                valList.push(obj);\n                            })\n\n                        });\n                        value = valList;\n                    } else {\n                        const ids = this.controlProperties[`v${controlUuid}`].value;\n                        let list = this.controlProperties[`v${element.controlUuid}`].dataSourceList.filter(v => {\n                            return ids.find(m => m === v.id);\n                        });\n                        let valList = [];\n                        list.forEach(valItem => {\n                            const obj = {};\n                            element.children.forEach(item => {\n                                const keyItem = item.subControlUuid;\n                                const paramsName = item.paramsName;\n                                obj[paramsName] = valItem[keyItem];\n                            });\n                            valList.push(obj);\n                        });\n                        value = valList;\n                    }\n                } else {\n                    //无子集\n                    if (!control.dataProperty.showRowSelection) {\n                        value = this.selectList[controlUuid].resultData.map(v => v.id);\n                    } else {\n                        value = this.controlValues[controlUuid];\n                    }\n                }\n\n            }\n            return value;\n        },\n        // 设置容器条件\n        setWhere(where){\n            where.or &&\n            where.or.forEach(orItem => {\n                orItem.and &&\n                    orItem.and.forEach(andItem => {\n                        if (andItem.south === 'controlValue') {\n                            const val = this.getControlFlowVal(andItem.controls, andItem);\n                            andItem.value = val;\n                            andItem.right = val;\n                        }\n                        if (andItem.south === 'pageparams') {\n                            andItem.value = this.$route.query[andItem.pageparams[andItem.pageparams.length - 1]];\n                            andItem.right = this.$route.query[andItem.pageparams[andItem.pageparams.length - 1]];\n                        }\n                        \n                        andItem.table_uuid = andItem.table_uuid || whereParams.model_uuid;\n                        if (andItem.right === '') {\n                            \n                        }\n                    });\n            });\n        },\n        async conditionJudge(orList,globalVariableList, $scoped){\n            \t//条件判断\n\t\t\tlet str = [];\n\t\t\tfor (let j = 0; j < orList.length; j++) {\n\t\t\t\tconst orItem = orList[j];\n\t\t\t\tlet andStr = [];\n\t\t\t\tfor (let i = 0; i < orItem.and.length; i++) {\n\t\t\t\t\tconst andItem = orItem.and[i];\n\t\t\t\t\tconst v1 = await this.getVal(andItem.beforeMatchType, globalVariableList,$scoped);\n\t\t\t\t\tconst v2 = await this.getVal(andItem.afterMatchType, globalVariableList,$scoped);\n\t\t\t\t\tlet type = andItem.matchType;\n\t\t\t\t\tlet str = `'${v1}'${type}'${v2}'`;\n\t\t\t\t\tif (['>=', '>', '<=', '<'].includes(type)) {\n\t\t\t\t\t\tstr = `${v1}${type}${v2}`;\n\t\t\t\t\t}\n\t\t\t\t\tif (['includes', 'startWith', 'endsWith'].includes(type)) {\n\t\t\t\t\t\t//包含，开始，结束\n\t\t\t\t\t\tstr = `'${v1}'.${type}('${v2}')`;\n\t\t\t\t\t}\n\t\t\t\t\tif (type === '!includes') {\n\t\t\t\t\t\t//包含\n\t\t\t\t\t\tstr = `!'${v1}'.includes('${v2}')`;\n\t\t\t\t\t}\n\t\t\t\t\tif ([`==''`].includes(type)) {\n\t\t\t\t\t\t//为空\n\t\t\t\t\t\tstr = `('${v1}'==''||'${v1}'.length==0)`;\n\t\t\t\t\t}\n\t\t\t\t\tif ([`!=''`].includes(type)) {\n\t\t\t\t\t\t//不为空\n\t\t\t\t\t\tstr = `('${v1}'!=''&&'${v1}'.length>0)`;\n\t\t\t\t\t}\n\n\t\t\t\t\tandStr.push(str);\n\t\t\t\t\tconsole.log('v1=', v1, 'v2=', v2, 'andStr', andStr);\n\t\t\t\t}\n\t\t\t\tconsole.log('and', andStr);\n\t\t\t\tstr.push(andStr.join('&&'));\n\t\t\t}\n\t\t\tconst jsStr = str.join('||');\n\t\t\ttry {\n\t\t\t\treturn eval(jsStr) || false;\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('判断出错', e);\n\t\t\t\treturn false;\n\t\t\t}\n        },\n                \n                \n                  async  start(start, flowMap, paramsArr, next){\n                            },\n                \n                \n                  async  setValue(setValue, flowMap, paramsArr, next){\n                            \n      let list = [];\n      if (setValue.list && setValue.list.length > 0) {\n        list = setValue.list;\n      } else {\n        list = setValue;\n      }\n      const setValueList = list.map((v) => {\n        const item = v;\n        item.source = item.source || item.actionType;\n        return item;\n      });\n        for (let i = 0; i < setValueList.length; i++) {\n          const item = setValueList[i]\n        const val = await this.getVal(item, paramsArr?.globalVariableList, this.tableItem);\n        this.controlProperties[`v${item.controlTargetUuid}`].value = val;\n      }\n      this.goNext(next, flowMap, paramsArr);\n},\n                \n                \n                  async  delayThe(delayThe, flowMap, paramsArr, next){\n                            \n    //延迟执行\n    const th = this;\n    const {delayNumber, delayType} = delayThe;\n    const num = delayType === 's' ? delayNumber * 1000 : delayNumber;\n    setTimeout(() => {\n        this.goNext(next, flowMap, paramsArr);\n    }, num);\n},\n                \n                \n                  async  initFormDetail(initFormDetail, flowMap, paramsArr, next){\n                            },\n                \n                async invokeFlow(invokeFlow, flowMap, paramsArr, invokeFlowNext){\n     const req = invokeFlow?.req || [];\n            const res = invokeFlow?.res;\n            const processId = invokeFlow?.processId;\n            const formData = { system_pb: {} };\n            for (var i = 0; i < req.length; i++) {\n                const element = req[i];\n                if (element.source === \"url\") {\n                    formData[element.paramsName] =\n                        this.$route.query[element.fieldparamName];\n                } else if (element.source === \"page\") {\n                    if (element.controlUuid) {\n                        if (element.subControlUuid) {\n                            formData[element.paramsName] = this.tableItem[element.subControlUuid];\n                        } else {\n                            formData[element.paramsName] = this.getControlFlowVal(element.controlUuid, element);\n                        }\n                    }\n\n                } else if (element.source === \"globalValue\") {\n                    const res =\n                        await this.$get(\"/process/v1/queryGlobalValueByKey\", {\n                            fieldNameKey: element.fieldNameKey,\n                        })\n                    formData[element.paramsName] = res.data.fieldNameValue;\n                } else if (element.source === \"globalVariableValue\") {\n                    formData[element.paramsName] = paramsArr.globalVariableList[element.globalVariableValue];\n                }\n            }\n            const params = {\n                processJsonUUid: processId,\n                paramsJson: JSON.stringify({ data: formData }),\n            };\n\n\n\n            if (res && res.length === 1 && res[0].response.length === 1 && res[0].response[0].paramsType === 'FileIo') {\n                const response = await this.$postGetfile(\n                    `/process/v1/${invokeFlow?.processId}`,\n                    params,\n                    {\n                        responseType: 'blob',\n                        getResponse: true\n                    }\n                );\n                let blob = response.data\n                let reader = new FileReader()\n                reader.readAsDataURL(blob)\n                reader.onload = (e) => {\n                    let a = document.createElement('a')\n                    a.download = decodeURI(response.headers['content-disposition'].split('filename=')[1])\n                    a.href = e.target.result\n                    document.body.appendChild(a)\n                    a.click()\n                    document.body.removeChild(a)\n                }\n                return\n            }\n\n\n            const response = await this.$post(`/process/v1/${invokeFlow?.processId}`, params);\n            const data = response.data;\n            res.map((item) => {\n                if (item.resresultType.includes(data.system_returnBelong)) {\n                    if (item.resresult === \"flowrespage\") {\n                        item.response.forEach((element) => {\n                            this.setControlProperties(element, data[element.paramsName], params, paramsArr);\n                        });\n                        if (invokeFlowNext && invokeFlowNext.length > 0) {\n                            const v = invokeFlowNext.find(\n                                (v) => v.resBelongid === data.system_returnBelong\n                            ).Next;\n                            this.loop(v, flowMap, paramsArr);\n                        }\n                    } else {\n                        this.loop(item.actionNext, flowMap, paramsArr);\n                    }\n                }\n            });\n\n},\n            \n                \n                  async  messageTips(messageTips, flowMap, paramsArr, next){\n                            \n    this.$message.config({\n        top: messageTips.tipsTopPosition || \"24px\",\n        duration: 2,\n        maxCount: 3,\n    });\n    this.$message[`${messageTips.tipsType}`]({\n        content: messageTips.tipsDesc,\n        duration: messageTips.tipsTime || 3,\n    });\n    const _th = this;\n    if (next) {\n        setTimeout(() => {\n            let nextList = [];\n            if (typeof next === 'string') {\n                nextList = [next];\n            } else {\n                nextList = next;\n            }\n            nextList.forEach(v => {\n                _th.loop(v, flowMap, paramsArr);\n            });\n        }, messageTips.tipsTime * 1000);\n    }                      \n\n},\n                openPage(openPage){\n    this.getParams(openPage);\n    if(openPage.blank) {\n         const routeUrl = this.$router.resolve({\n            path: `/page${openPage.pageUuid}`,\n            query: {\n                ...this.paramJson\n            }\n        });\n        window.open(window.location.origin + routeUrl.href, '_blank')\n    }else {\n       this.$router.push({\n            path: `/page${openPage.pageUuid}`,\n            query: {\n                ...this.paramJson\n            }\n        });\n    }\n},\n            \n                \n                  async  dialogOpen(dialogOpen, flowMap, paramsArr, next){\n                            \n      let primaryKeyUuid = '';\n      let primaryKeyEnName = '';\n      if (this.tableItem) {\n        if(dialogOpen.subparamValue) {\n            const subparamValue =  dialogOpen.subparamValue;\n            if (subparamValue) {\n              primaryKeyUuid = this.tableItem[subparamValue];\n              primaryKeyEnName = subparamValue;\n            }\n        }\n      }\n      this.drawerList.push({\n        controlUuid:`v${dialogOpen.controlUuid}`,\n        primaryKeyUuid: primaryKeyUuid,\n        tableItem: this.tableItem,\n        primaryKeyEnName: primaryKeyEnName\n      });\n\n      if (next) {\n          let nextList = [];\n          if (typeof next === \"string\") {\n              nextList = [next];\n          } else {\n              nextList = next;\n          }\n          nextList.forEach((v) => {\n              this.loop(v, flowMap, paramsArr);\n          });\n      }\n\n},\n                \n                \n                  async  saveData(saveData, flowMap, paramsArr, next){\n                            },\n                \n                \n                  async  dialogClose(dialogClose, flowMap, paramsArr, next){\n                            \n\n    const drawerList = this.drawerList.filter(v => v.controlUuid !== `v${dialogClose.controlUuid}`);\n    this.drawerList = JSON.parse(JSON.stringify(drawerList));\n    this.goNext(next, flowMap, paramsArr);\n\n},\n                \n                \n                  async  notifications(notifications, flowMap, paramsArr, next){\n                            \n    const params = notifications.iconSwitch ? {\n        placement: notifications.locationType,\n        duration: notifications.tipsTime || 3,\n        icon: notifications.iconSwitch,\n        top: notifications.tipsTopPosition || '20px'\n    }: {\n        placement: notifications.locationType,\n        duration: notifications.tipsTime || 3,\n        top: notifications.tipsTopPosition || '20px'\n    }\n    this.$notification.config(params);\n    if(notifications.iconSwitch){\n        this.$notification[notifications.tipsType]({\n            message: notifications.tipsTitle,\n            description: notifications.tipsDesc\n        });\n    }else {\n        this.$notification.open({\n            message: notifications.tipsTitle,\n            description: notifications.tipsDesc\n        });\n    }\n    const _th = this;\n    if (next) {\n        setTimeout(() => {\n            let nextList = [];\n            if (typeof next === 'string') {\n                nextList = [next];\n            } else {\n                nextList = next;\n            }\n            nextList.forEach(v => {\n                _th.loop(v, flowMap, paramsArr);\n            });\n        }, notifications.tipsTime * 1000);\n    }\n     \n},\n                \n                \n                  async  getFilterTableList(getFilterTableList, flowMap, paramsArr, next){\n                            },\n                \n                \n                  async  editObject(editObject, flowMap, paramsArr, next){\n                            \n   const params = Object.assign(\n      { actionType: editObject.editType },\n      {\n        [editObject.editType]: editObject[editObject.editType],\n      }\n    );\n    this[params.actionType](params[params.actionType]);\n\n    this.pageQuery.primaryId = this.tableItem.id;\n    this.pageQuery.primaryKey = editObject.dialogOpen.subparamValue;\n    const formIds = editObject.dialogOpen.dataFormIds;\n    formIds.forEach((v) => {\n      this[`initFormDetail${v}`](editObject.dialogOpen.subparamValue);\n    });\n    this.goNext(next, flowMap, paramsArr);\n},\n                \n                \n                  async  setLookupValue(setLookupValue, flowMap, paramsArr, next){\n                            },\n                \n                confirm(confirm, flowMap, paramsArr, choiceNext){\n    const _th = this;\n    this.$confirm({\n        title: confirm?.tipsTitle,\n        content: confirm?.tipsDesc,\n        okText: \"确认\",\n        cancelText: \"取消\",\n        visible: true,\n        onOk() {\n            const next = choiceNext?.find((v) => v.isTrue).Next;\n            next && next && _th.loop(next, flowMap, paramsArr);\n        },\n        onCancel() {\n            const next = choiceNext?.find((v) => !v.isTrue).Next;\n            next && next && _th.loop(next, flowMap, paramsArr);\n        },\n    });\n\n},\n            \n                \n                  async  refreshData(refreshData, flowMap, paramsArr, next){\n                            \n\n    refreshData?.controlList?.forEach(item => {\n        this.refreshData(item);\n        const type = this.controlProperties[`v${item}`].dataSourceType;\n        const basetype = this.controlProperties[`v${item}`].type;\n        const req = this.controlProperties[`v${item}`].req;\n        if (['Tree','TreeContainer'].includes(basetype)){\n            this[`getFilterTableList${item}`](item)\n            return \n        }\n        if(type === 'flow') {\n            let System_Page = {};\n            const paramsJson = JSON.parse(req.paramsJson);\n            paramsJson.data.System_Page = System_Page;\n            req.paramsJson = JSON.stringify(paramsJson);\n            this.$post(`/process/v1/${req.processJsonUUid}`, req).then((res) => {\n                const resultData = this[`setLookupValue${item}`](res.data[req.flowresParamsName])\n                this.controlProperties[`v${item}`].dataSourceList = resultData;\n                \n\n                this.controlProperties[`v${item}`].pagination =\n                res.data[req.flowresParamsName];\n            });\n        }else if(type === 'entity') {\n           const where = this.controlProperties[`v${item}`].whereParams;\n            this.setWhere(where.where);\n            this.$post(\"/process/v1/datagridQuery\", { data: where }).then((res) => {\n                const result = res.data.list;\n\n                this.controlProperties[`v${item}`].pagination = result.pagination ?? {};\n                \n                const resultData = this[`setLookupValue${item}`](result)\n                this.controlProperties[`v${item}`].dataSourceList = resultData;\n                this[`getFilterTableList${item}`](item);\n            });\n        }\n    });\n\n    this.goNext(next, flowMap, paramsArr);\n    \n},\n                \n                \n                  async  hideControls(hideControls, flowMap, paramsArr, next){\n                            },\n                \n            \n                 async setControlProperties(element, res, params, paramsArr) {\n                    let value = res\n                    if (element.controlUuid) {\n                    if (element.istemplate) {\n                        value = this.template(this.controlProperties[`v${element.controlUuid}`], {\n                        [element.paramsName]: data[element.paramsName],\n                        })\n                    }\n                    if (element.paramsType === 'Lookup') {\n                        const list = res.map((v) => {\n                        return v.columns\n                        })\n\n                        value = { resultData: list }\n                    }\n                    if (element.baseType && ['List', 'Lookup'].includes(element.paramsType)) {\n                        if (element.baseType === 'Tag') {\n                        if (element.paramsType === 'Lookup') {\n                            this.controlProperties[`v${element.controlUuid}`].value = value[element.subFieldId]\n                        } else {\n                            const datalist = value.resultData.map((m) => {\n                            return {\n                                columns: { ...m },\n                                uuid: m.id,\n                            }\n                            })\n                            this.controlProperties[`v${element.controlUuid}`].value = datalist\n                        }\n                        } else {\n                        if (!value.resultData) {\n                            value = { resultData: value }\n                        }\n\n                         const resultData = this[`setLookupValue${element.controlUuid}`](value)\n\n                        this.controlProperties[`v${element.controlUuid}`].dataSourceList = resultData\n\n                        }\n                    } else {\n                        if (\n                        element.baseType &&\n                        ['TableView', 'ListView', 'CardView', 'TableContainer'].includes(element.baseType) &&\n                        element.subFieldId &&\n                        this.tableItem\n                        ) {\n                        if (this.dataControl.dataIndex > -1 && this.dataControl.advancedUuid) {\n                            const fieldId = element.subFieldId\n                            if (fieldId) {\n                            this.controlProperties[`v${fieldId}`].dataSource = value\n                            return\n                            }\n                        }\n                        }\n\n                        this.controlProperties[`v${element.controlUuid}`].value = value\n                    }\n                    this.controlProperties[`v${element.controlUuid}`].req = {\n                        ...params,\n                        flowresParamsName: element.paramsName,\n                        belong: element.belong,\n                        type: 'flow',\n                    }\n                    }\n                    if (element.isVarable) {\n                    if (!paramsArr.globalVariableList) paramsArr.globalVariableList = {}\n                    paramsArr.globalVariableList[element.paramsName] = value\n                    }\n\n                    if (element.paramsType !== 'List' && element.children && element.children.length > 0) {\n                    element.children.forEach((item) => {\n                        if (res && res.hasOwnProperty(item.paramsName)) {\n                        if (\n                            item.paramsType === 'Lookup' &&\n                            !item.multiple &&\n                            res[item.paramsName] instanceof Array &&\n                            res[item.paramsName].length === 1\n                        ) {\n                            this.setControlProperties(item, res[item.paramsName][0].columns, params, paramsArr)\n                        } else {\n                            this.setControlProperties(item, res[item.paramsName], params, paramsArr)\n                        }\n                        }\n                    })\n                    }\n\n                    // 增加生成token，存储token\n                    if (element.paramsType === 'TOKEN') {\n                    sessionStorage.setItem('token', res)\n                    }\n                },\n            getParams(openPage) {\n                    this.paramJson = {};\n                    const { parameList } = openPage;\n                    parameList.forEach((item) => {\n                        if (item.paramName === '_editObjectid_') {\n                            this.paramJson['_editObjectPrimaryKey_'] =\n                            this.paramJson['_editObjectPrimaryKey_'] || item.subparamValue\n                        }\n                        this.paramJson[item.paramName] = this.getParamUrl(item)\n                    })\n                },\n                getParamUrl(item) {\n                    if (item.paramSource === 'url') {\n                        return this.$route.query[item.fieldparamName];\n                    } else if (item.subparamValue) {\n                        return this.gettableItem(item.subparamValue);\n                    } else if (item.paramSource === 'cursorm') {\n                        return item.cursormValue;\n                    } else {\n                        return this.controlProperties[`v${item.controlUuid}`].value;\n                    }\n                },\n            \n                dialogOpen(dialogOpen, flowMap, paramsArr, next){\n      let primaryKeyUuid = '';\n      let primaryKeyEnName = '';\n      if (this.tableItem) {\n        if(dialogOpen.subparamValue) {\n            const subparamValue =  dialogOpen.subparamValue;\n            if (subparamValue) {\n              primaryKeyUuid = this.tableItem[subparamValue];\n              primaryKeyEnName = subparamValue;\n            }\n        }\n      }\n      this.drawerList.push({\n        controlUuid:`v${dialogOpen.controlUuid}`,\n        primaryKeyUuid: primaryKeyUuid,\n        tableItem: this.tableItem,\n        primaryKeyEnName: primaryKeyEnName\n      });\n\n      if (next) {\n          let nextList = [];\n          if (typeof next === \"string\") {\n              nextList = [next];\n          } else {\n              nextList = next;\n          }\n          nextList.forEach((v) => {\n              this.loop(v, flowMap, paramsArr);\n          });\n      }\n\n},\n            gettableItem(subitem) {\n            return this.tableItem[subitem];\n            \n        },\n\n        /* 获取lookup数据\n\t\t * @param {Array} lookupIdList lookup数组\n\t\t * @param {Array} list 数据\n\t\t * 递归\n\t\t */\n\t\tgetLookupData(lookupIdList, list) {\n\t\t\tlet [lookupId, ...lookupList] = lookupIdList;\n\t\t\tlet result = [];\n            if(list instanceof Array)\n\t\t\tlist.map(item => {\n\t\t\t\tif (lookupList.length) {\n\t\t\t\t\tresult.push(this.getLookupData(lookupList, item.columns[lookupId]));\n\t\t\t\t} else {\n\t\t\t\t\tif (item.columns[lookupId] instanceof Object) {\n\t\t\t\t\t\tresult.push(item.columns[lookupId].fields);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.push(item.columns[lookupId]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn result.join(',');\n\t\t},\n        getLookupList(list){\n            if(list instanceof Array){\n                let result = []\n                result = list.map(item => item.uuid)\n                return result.join(',')\n            }\n          return list\n\n        },\n        loop(start, flowMap, paramsArr) {\n            let actionType = flowMap[start]?.actionType;\n            let current = flowMap[start]?.current;\n            let Next = flowMap[start]?.Next;\n            if (actionType === \"choice\") {\n                actionType &&\n                    this[actionType](\n                        paramsArr[current],\n                        flowMap,\n                        paramsArr,\n                        flowMap[start].choiceNext,\n                        paramsArr?.globalVariableList\n                    );\n            } else if (actionType === \"choose\") {\n                actionType &&\n                    this[actionType](\n                        paramsArr[current],\n                        flowMap,\n                        paramsArr,\n                        paramsArr?.globalVariableList\n                    );\n            } else if (actionType === \"confirm\") {\n                 actionType &&\n                        this[actionType](paramsArr[current], flowMap, paramsArr, flowMap[start].choiceNext);\n            } else if((actionType === 'saveData' || actionType === 'deleteObject') && current){\n                this[current]();\n                if(Next){\n                let nextList = [];\n                if (typeof Next === \"string\") {\n                    nextList = [Next];\n                } else {\n                    nextList = Next;\n                }\n                nextList.forEach((v) => {\n                    this.loop(v, flowMap, paramsArr);\n                });\n                }\n            } else if (actionType === \"invokeFlow\" ){\n                actionType && this[actionType](paramsArr[current], flowMap, paramsArr, flowMap[start]?.invokeFlowNext);\n            } else {\n                actionType && this[actionType](paramsArr[current], flowMap, paramsArr, Next);\n            }\n        },\n        template(str, o) {\n            const re = /{(.+?)}/g;\n            return str.replace(re, function (match, name) {\n                return o[name] === undefined ? `{${name}}` : o[name];\n            });\n        },\n        async getVal(obj,globalVariableList,$scoped){\n             let value = '';\n            if (obj.source === 'customSetValue') {\n                //自定义\n                if (obj.valueVariableList && obj.valueVariableList.length > 0) {\n                    if (obj.valueVariableListObj) {\n                        const val = await this.getVal(obj.valueVariableListObj, globalVariableList);\n                        return this.template(obj.value, {\n                            [obj.valueVariableList.join('/')]: val\n                        });\n                    } else {\n                        let v = obj.value;\n\n                        for (let i = 0; i < obj.valueVariableList.length; i++) {\n                            const val = await this.getVal(obj.valueVariableList[i], globalVariableList);\n                            v = this.template(v, {\n                                [obj.valueVariableList[i].valueList.join('/')]: val\n                            });\n                        }\n                        return v;\n                    }\n                }\n                return obj.value;\n            } else if (obj.source === 'controlValue') {\n                //组件\n                return this.getControlFlowVal(obj.controlUuid);\n            } else if (obj.source === 'globalValue') {\n                //环境变量\n                let res = await this.$get('/process/v1/queryGlobalValueByKey', {\n                    fieldNameKey: obj.globalValue\n                });\n                value = res.data.fieldNameValue;\n                return value;\n            } else if (obj.source === 'url' || obj.source === 'urlSetValue') {\n                //url\n                return this.$route.query[obj.pageparams] || '';\n            } else if (obj.source === 'globalVariableValue') {\n                return globalVariableList[obj.globalVariableValue]\n            } else if (obj.source === 'property' && ($scoped|| this.tableItem)) {\n                //组件属性\n                const item = $scoped||this.tableItem;\n                 if (obj.optionProperty) {\n                const data = item[obj.fieldId]\n                const valList = data.fields.map((item) => {\n                    const val = JSON.parse(item.data)\n                    return val[obj.optionProperty]\n                })\n                return valList.join('/')\n                } else {\n                return item[obj.fieldId]\n                }\n            } else if (obj.source === 'dataSet') {\n                let res = {}\n                if (this.option[obj.optionSetEnName]) {\n                res = this.option[obj.optionSetEnName]\n                } else {\n                res = await this.$get('/dam/v1/wlosOptionData/noPage/list', {\n                    optionUuid: obj.optionSetEnName,\n                })\n                this.$set(this.option, obj.optionSetEnName, res)\n                }\n                const data = res.data.map((item) => {\n                return JSON.parse(item.data)\n                })\n                return data.find((v) => obj.optionDataId === v.id)[obj.optionProperty]\n            }\n            return '';\n        },\n\n        async getValV2(constVal,$scoped){\n            if(constVal[0].classification==='controlsGroup'){\n                const controls=(constVal.find(v=>v.classification==='controls')||{}).dataKey\n                const properties=(constVal.find(v=>v.classification==='properties')||{}).dataKey\n                return this.controlProperties[`v${controls}`][properties]\n            }\n        },\n        goNext(next, flowMap, paramsArr){\n            if (next) {\n                let nextList = [];\n                if (typeof next === 'string') {\n                    nextList = [next];\n                } else {\n                    nextList = next;\n                }\n                nextList.forEach(v => {\n                    this.loop(v, flowMap, paramsArr);\n                });\n            }\n        }\n    },\n    beforeDestroy() {\n        clearInterval(this.timer)\n    }\n}\n\n"]}]}
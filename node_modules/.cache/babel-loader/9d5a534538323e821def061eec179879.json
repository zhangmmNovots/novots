{"remainingRequest":"/node/src/code-factory/node_modules/babel-loader/lib/index.js!/node/src/code-factory/node_modules/cache-loader/dist/cjs.js??ref--1-0!/node/src/code-factory/node_modules/vue-loader/lib/index.js??vue-loader-options!/node/src/code-factory/lsrkyyezwbvy/src/components/writingPad.vue?vue&type=script&lang=js&","dependencies":[{"path":"/node/src/code-factory/lsrkyyezwbvy/src/components/writingPad.vue","mtime":1649314960041},{"path":"/node/src/code-factory/lsrkyyezwbvy/babel.config.js","mtime":1649314958358},{"path":"/node/src/code-factory/node_modules/cache-loader/dist/cjs.js","mtime":1648824486287},{"path":"/node/src/code-factory/node_modules/babel-loader/lib/index.js","mtime":1648824338096},{"path":"/node/src/code-factory/node_modules/cache-loader/dist/cjs.js","mtime":1648824486287},{"path":"/node/src/code-factory/node_modules/vue-loader/lib/index.js","mtime":1648824494917}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLm1hdGNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmF0b2IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWV4Y2VwdGlvbi5jb25zdHJ1Y3Rvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tZXhjZXB0aW9uLnN0YWNrLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1leGNlcHRpb24udG8tc3RyaW5nLXRhZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS51aW50OC1hcnJheS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmF0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuY29weS13aXRoaW4uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5ldmVyeS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbGwuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maW5kLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmluZC1pbmRleC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pbmRleC1vZi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5Lml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuam9pbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5Lmxhc3QtaW5kZXgtb2YuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5yZWR1Y2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5yZWR1Y2UtcmlnaHQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5yZXZlcnNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc2V0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc2xpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zb21lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc29ydC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnN1YmFycmF5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudG8tbG9jYWxlLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnRvLXN0cmluZy5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCB7IGJhc2VVUkwgfSBmcm9tICdAL3V0aWwvdXRpbCc7CmltcG9ydCB1cGxvYWQgZnJvbSAnQC9jb21wb25lbnRzL3VwbG9hZCc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnd3JpdGluZ1BhZCcsCiAgcHJvcHM6IHsKICAgIC8vIOacrOWcsOS4iuS8oCAg6L+Y5piv5LiD54mb5LiK5LygCiAgICB0eXBlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogIiIKICAgIH0sCiAgICAvLyDllK/kuIDlgLwKICAgIHV1aWQ6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAiIgogICAgfSwKICAgIC8vIOWfn+WQjQogICAgZG9tYWluOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogIiIKICAgIH0sCiAgICAvLyDmnKzlnLDlrZjlgqjot6/lvoQKICAgIHNhdmVQYXRoOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJycKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjdHg6ICcnLAogICAgICBwb2ludHM6IFtdLAogICAgICBjYW52YXM6ICcnLAogICAgICB0aW1lck91dDogbnVsbCwKICAgICAgdXBsb2FkVXJsOiBiYXNlVVJMICsgJy9wcm9jZXNzL3YxL3VwbG9hZEZpbGUnCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgaW5pdFdyaXRpbmdQYWQ6IGZ1bmN0aW9uIGluaXRXcml0aW5nUGFkKCkgewogICAgICB2YXIgY2FudmFzID0gdGhpcy4kcmVmcy5jYW52YXM7CiAgICAgIGNhbnZhcy53aWR0aCA9IHRoaXMuJHJlZnMuY2FudmFzLnBhcmVudE5vZGUuY2xpZW50V2lkdGg7CiAgICAgIGNhbnZhcy5oZWlnaHQgPSB0aGlzLiRyZWZzLmNhbnZhcy5wYXJlbnROb2RlLmNsaWVudEhlaWdodDsKICAgICAgdGhpcy5jdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTsKICAgICAgdGhpcy5jdHgubGluZVdpZHRoID0gNDsKICAgICAgdGhpcy5jdHgubGluZUNhcCA9ICdyb3VuZCc7CiAgICAgIHRoaXMuY3R4LmxpbmVKb2luID0gJ3JvdW5kJzsKICAgICAgdGhpcy5jYW52YXMgPSB0aGlzLiRyZWZzWydjYW52YXMnXTsKICAgIH0sCiAgICBnZXRNb3VzZVBvczogZnVuY3Rpb24gZ2V0TW91c2VQb3MoY2FudmFzLCBldnQpIHsKICAgICAgdmFyIHJlY3QgPSBjYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIHJldHVybiB7CiAgICAgICAgeDogZXZ0LmNsaWVudFggLSByZWN0LmxlZnQgKiAocmVjdC53aWR0aCAvIGNhbnZhcy53aWR0aCksCiAgICAgICAgeTogZXZ0LmNsaWVudFkgLSByZWN0LnRvcCAqIChjYW52YXMuaGVpZ2h0IC8gcmVjdC5oZWlnaHQpCiAgICAgIH07CiAgICB9LAoKICAgIC8qIOeCueWHu+eahOaXtuWAmeS/neWtmOS4i+adpeS9jee9rgogICAgICogQHBhcmFtIHtlfSBlIOiHquWumuS5ieWxnuaApwogICAgICovCiAgICBtb3VzZWRvd246IGZ1bmN0aW9uIG1vdXNlZG93bihlKSB7CiAgICAgIHZhciBvYmogPSB0aGlzLmdldE1vdXNlUG9zKGUudGFyZ2V0LCBlKTsKICAgICAgdmFyIHN0YXJ0WCA9IG9iai54OwogICAgICB2YXIgc3RhcnRZID0gb2JqLnk7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgdmFyIHN0YXJ0UG9pbnQgPSB7CiAgICAgICAgWDogc3RhcnRYLAogICAgICAgIFk6IHN0YXJ0WQogICAgICB9OwogICAgICB0aGlzLnBvaW50cy5wdXNoKHN0YXJ0UG9pbnQpOwogICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTsKICAgIH0sCgogICAgLyog56e75Yqo55qE5pe25YCZ5L+d5a2Y5LiL5p2l5L2NZGQKICAgICogQHBhcmFtIHtlfSBlIOiHquWumuS5ieWxnuaApwogICAgKi8KICAgIG1vdXNlbW92ZTogZnVuY3Rpb24gbW91c2Vtb3ZlKGUpIHsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgaWYgKHRoaXMucG9pbnRzLmxlbmd0aCkgewogICAgICAgIHZhciBvYmogPSB0aGlzLmdldE1vdXNlUG9zKGUudGFyZ2V0LCBlKTsKICAgICAgICB2YXIgbW92ZVggPSBvYmoueDsKICAgICAgICB2YXIgbW92ZVkgPSBvYmoueTsKICAgICAgICB2YXIgbW92ZVBvaW50ID0gewogICAgICAgICAgWDogbW92ZVgsCiAgICAgICAgICBZOiBtb3ZlWQogICAgICAgIH07CiAgICAgICAgdGhpcy5wb2ludHMucHVzaChtb3ZlUG9pbnQpOyAvL+WtmOeCuQoKICAgICAgICB2YXIgbGVuID0gdGhpcy5wb2ludHMubGVuZ3RoOwoKICAgICAgICBpZiAobGVuID49IDIpIHsKICAgICAgICAgIHRoaXMuZHJhdygpOyAvL+e7mOWItui3r+W+hAogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICAvKiDnlLsgKi8KICAgIGRyYXc6IGZ1bmN0aW9uIGRyYXcoKSB7CiAgICAgIHZhciBwb2ludDEgPSB0aGlzLnBvaW50c1swXTsKICAgICAgdmFyIHBvaW50MiA9IHRoaXMucG9pbnRzWzFdOwogICAgICB0aGlzLnBvaW50cy5zaGlmdCgpOwogICAgICB0aGlzLmN0eC5tb3ZlVG8ocG9pbnQxLlgsIHBvaW50MS5ZKTsKICAgICAgdGhpcy5jdHgubGluZVRvKHBvaW50Mi5YLCBwb2ludDIuWSk7CiAgICAgIHRoaXMuY3R4LnN0cm9rZSgpOwogICAgfSwKCiAgICAvKiDmuIXnqbpjYW52YXMgKi8KICAgIGNsZWFyQ2FudmFzOiBmdW5jdGlvbiBjbGVhckNhbnZhcygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAvLyDph43nva7nlLvluIMKICAgICAgICBfdGhpcy5jdHguY2xlYXJSZWN0KDAsIDAsIF90aGlzLiRyZWZzWydjYW52YXMnXS53aWR0aCwgX3RoaXMuJHJlZnNbJ2NhbnZhcyddLmhlaWdodCk7IC8vIOa4heepuuaVsOaNrgoKCiAgICAgICAgX3RoaXMuJGVtaXQoJ2NoYW5nZScsICcnKTsKICAgICAgfSk7CiAgICB9LAoKICAgIC8qIOinpuaRuOe7k+adn++8jOWwhuacque7mOWItueahOeCuea4heepuumYsuatouWvueWQjue7rei3r+W+hOS6p+eUn+W5suaJsCAqLwogICAgbW91c2V1cDogZnVuY3Rpb24gbW91c2V1cCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLnRpbWVyT3V0ICYmIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyT3V0KTsKICAgICAgdGhpcy5wb2ludHMgPSBbXTsKICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBibG9iID0gX3RoaXMyLmRhdGFVUkx0b0Jsb2IoX3RoaXMyLiRyZWZzLmNhbnZhcy50b0RhdGFVUkwoJ2ltYWdlL3BuZycpKTsKCiAgICAgICAgYmxvYi5uYW1lID0gX3RoaXMyLiR1dWlkKCkgKyAnd3JpdGluZ1BhZC5wbmcnOwogICAgICAgIF90aGlzMi50aW1lck91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMyLnVwbG9hZEZpbGUoYmxvYik7CiAgICAgICAgfSwgMTAwMCk7CiAgICAgIH0pOwogICAgfSwKCiAgICAvKiBiYXNlNjTovaxibG9iCiAgICAqIEBwYXJhbSB7U3RyaW5nfSBiYXNldXJsIGJhc2U2NAogICAgKi8KICAgIGRhdGFVUkx0b0Jsb2I6IGZ1bmN0aW9uIGRhdGFVUkx0b0Jsb2IoYmFzZXVybCkgewogICAgICB2YXIgYXJyID0gYmFzZXVybC5zcGxpdCgnLCcpLAogICAgICAgICAgbWltZSA9IGFyclswXS5tYXRjaCgvOiguKj8pOy8pWzFdLAogICAgICAgICAgYnN0ciA9IGF0b2IoYXJyWzFdKSwKICAgICAgICAgIG4gPSBic3RyLmxlbmd0aCwKICAgICAgICAgIHU4YXJyID0gbmV3IFVpbnQ4QXJyYXkobik7CgogICAgICB3aGlsZSAobi0tKSB7CiAgICAgICAgdThhcnJbbl0gPSBic3RyLmNoYXJDb2RlQXQobik7CiAgICAgIH0KCiAgICAgIHJldHVybiBuZXcgQmxvYihbdThhcnJdLCB7CiAgICAgICAgdHlwZTogbWltZQogICAgICB9KTsKICAgIH0sCgogICAgLyog5LiK5Lyg5paH5Lu2CiAgICAqIEBwYXJhbSB7QmxvYn0gZmlsZSDmlofku7YKICAgICovCiAgICB1cGxvYWRGaWxlOiBmdW5jdGlvbiB1cGxvYWRGaWxlKGZpbGUpIHsKICAgICAgdGhpcy4kcmVmcy51cGxvYWQudXBsb2FkRmlsZSh0cnVlLCBmaWxlKTsKICAgIH0sCgogICAgLyog5LiK5Lyg5aSx6LSlICovCiAgICB1cGxvYWRFcnJvcjogZnVuY3Rpb24gdXBsb2FkRXJyb3IoZXJyb3IpIHsKICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgfSwKCiAgICAvKiDkuIrkvKDmiJDlip8gKi8KICAgIHVwbG9hZENoYW5nZTogZnVuY3Rpb24gdXBsb2FkQ2hhbmdlKGZpbGUpIHsKICAgICAgdGhpcy4kZW1pdCgnY2hhbmdlJywgZmlsZSk7CiAgICB9CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5pbml0V3JpdGluZ1BhZCgpOwogIH0sCiAgY29tcG9uZW50czogewogICAgdXBsb2FkOiB1cGxvYWQKICB9Cn07"},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkBA;AACA;AAEA;AACAA,oBADA;AAEAC;AACA;AACAC;AACAA,kBADA;AAEAC;AAFA,KAFA;AAMA;AACAC;AACAF,kBADA;AAEAC;AAFA,KAPA;AAWA;AACAE;AACAH,kBADA;AAEAC;AAFA,KAZA;AAgBA;AACAG;AACAJ,kBADA;AAEAC;AAFA;AAjBA,GAFA;AAwBAI,MAxBA,kBAwBA;AACA;AACAC,aADA;AAEAC,gBAFA;AAGAC,gBAHA;AAIAC,oBAJA;AAKAC;AALA;AAOA,GAhCA;AAiCAC;AACAC,kBADA,4BACA;AACA;AACAJ;AACAA;AACA;AACA;AACA;AACA;AACA;AACA,KAVA;AAWAK,eAXA,uBAWAL,MAXA,EAWAM,GAXA,EAWA;AACA;AACA;AACAC,gEADA;AAEAC;AAFA;AAIA,KAjBA;;AAkBA;AACA;AACA;AACAC,aArBA,qBAqBAC,CArBA,EAqBA;AACA;AACA;AACA;AACAA;AACA;AACAC,iBADA;AAEAC;AAFA;AAIA;AACA;AACA,KAhCA;;AAiCA;AACA;AACA;AACAC,aApCA,qBAoCAH,CApCA,EAoCA;AACAA;;AACA;AACA;AACA;AACA;AACA;AACAC,kBADA;AAEAC;AAFA;AAIA,oCARA,CAQA;;AACA;;AACA;AACA,sBADA,CACA;AACA;AACA;AACA,KApDA;;AAqDA;AACAE,QAtDA,kBAsDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA7DA;;AA+DA;AACAC,eAhEA,yBAgEA;AAAA;;AACA;AACA;AACA,6FAFA,CAGA;;;AACA;AACA,OALA;AAMA,KAvEA;;AAwEA;AACAC,WAzEA,qBAyEA;AAAA;;AACA;AACA;AACA;AACA;;AACAC;AACA;AACA;AACA,SAFA,EAEA,IAFA;AAGA,OANA;AAOA,KAnFA;;AAoFA;AACA;AACA;AACAC,iBAvFA,yBAuFAC,OAvFA,EAuFA;AACA;AAAA,UACAC,iCADA;AAAA,UAEAC,mBAFA;AAAA,UAGAC,eAHA;AAAA,UAIAC,yBAJA;;AAKA;AACAA;AACA;;AACA;AACA/B;AADA;AAGA,KAnGA;;AAoGA;AACA;AACA;AACAgC,cAvGA,sBAuGAC,IAvGA,EAuGA;AACA;AACA,KAzGA;;AA0GA;AACAC,eA3GA,uBA2GAC,KA3GA,EA2GA;AACAC;AACA,KA7GA;;AA8GA;AACAC,gBA/GA,wBA+GAJ,IA/GA,EA+GA;AACA;AACA;AAjHA,GAjCA;AAqJAK,SArJA,qBAqJA;AACA;AACA,GAvJA;AAwJAC;AACAC;AADA;AAxJA","names":["name","props","type","default","uuid","domain","savePath","data","ctx","points","canvas","timerOut","uploadUrl","methods","initWritingPad","getMousePos","evt","x","y","mousedown","e","X","Y","mousemove","draw","clearCanvas","mouseup","blob","dataURLtoBlob","baseurl","mime","bstr","n","u8arr","uploadFile","file","uploadError","error","console","uploadChange","mounted","components","upload"],"sourceRoot":"src/components","sources":["writingPad.vue"],"sourcesContent":["<template>\n\t<div class=\"writing\" >\n\t\t<div class=\"writing-pad\">\n\t\t\t<canvas class=\"canvas\" ref=\"canvas\" @mousedown=\"mousedown\" @mousemove=\"mousemove\" @mouseup=\"mouseup\"></canvas>\n\t\t</div>\n\t\t<div class=\"writing-clear\" @click=\"clearCanvas\">清除</div>\n\t\t<upload v-show=\"false\" \n\t\t\t:uuid=\"uuid\"\n      :type=\"type\"\n      :domain=\"domain\"\n      :savePath=\"savePath\"\n\t\t\tref=\"upload\"\n\t\t\t@change=\"uploadChange\"\n\t\t\t@error=\"uploadError\"\n\t\t/>\n\t</div>\n</template>\n<script>\nimport {baseURL} from '@/util/util';\nimport upload from '@/components/upload'\n\nexport default{\n  name: 'writingPad',\n\tprops:{\n\t\t// 本地上传  还是七牛上传\n    type: {\n      type: String,\n      default: \"\",\n    },\n    // 唯一值\n    uuid: {\n      type: String,\n      default: \"\",\n    },\n    // 域名\n    domain: {\n      type: String,\n      default: \"\",\n    },\n\t\t// 本地存储路径\n\t\tsavePath: {\n\t\t\ttype: String,\n\t\t\tdefault: ''\n\t\t}\n\t},\n  data(){\n    return {\n\t\t  ctx: '',\n\t\t\tpoints: [],\n\t\t\tcanvas: '',\n\t\t\ttimerOut: null,\n      uploadUrl: baseURL + '/process/v1/uploadFile'\n    }\n  },\n  methods:{\n    initWritingPad(){\n      let canvas = this.$refs.canvas;\n      canvas.width = this.$refs.canvas.parentNode.clientWidth;\n      canvas.height = this.$refs.canvas.parentNode.clientHeight;\n      this.ctx = canvas.getContext('2d');\n      this.ctx.lineWidth = 4;\n      this.ctx.lineCap = 'round';\n      this.ctx.lineJoin = 'round';\n      this.canvas = this.$refs['canvas'];\n    },\n    getMousePos(canvas, evt) {\n\t\t\tvar rect = canvas.getBoundingClientRect();\n\t\t\treturn {\n\t\t\t\tx: evt.clientX - rect.left * (rect.width / canvas.width),\n\t\t\t\ty: evt.clientY - rect.top * (canvas.height / rect.height)\n\t\t\t};\n\t\t},\n\t\t/* 点击的时候保存下来位置\n\t\t * @param {e} e 自定义属性\n\t\t */\n\t\tmousedown(e) {\n\t\t\tconst obj = this.getMousePos(e.target, e);\n\t\t\tconst startX = obj.x;\n\t\t\tconst startY = obj.y;\n\t\t\te.preventDefault();\n\t\t\tconst startPoint = {\n\t\t\t\tX: startX,\n\t\t\t\tY: startY\n\t\t\t};\n\t\t\tthis.points.push(startPoint);\n\t\t\tthis.ctx.beginPath();\n\t\t},\n    /* 移动的时候保存下来位dd\n\t\t * @param {e} e 自定义属性\n\t\t */\n\t\tmousemove(e) {\n\t\t\te.preventDefault();\n\t\t\tif (this.points.length) {\n\t\t\t\tconst obj = this.getMousePos(e.target, e);\n\t\t\t\tlet moveX = obj.x;\n\t\t\t\tlet moveY = obj.y;\n\t\t\t\tlet movePoint = {\n\t\t\t\t\tX: moveX,\n\t\t\t\t\tY: moveY\n\t\t\t\t};\n\t\t\t\tthis.points.push(movePoint); //存点\n\t\t\t\tlet len = this.points.length;\n\t\t\t\tif (len >= 2) {\n\t\t\t\t\tthis.draw(); //绘制路径\n\t\t\t\t}\n\t\t\t}\n\t\t},\n    /* 画 */\n\t\tdraw() {\n\t\t\tlet point1 = this.points[0];\n\t\t\tlet point2 = this.points[1];\n\t\t\tthis.points.shift();\n\t\t\tthis.ctx.moveTo(point1.X, point1.Y);\n\t\t\tthis.ctx.lineTo(point2.X, point2.Y);\n\t\t\tthis.ctx.stroke();\n\t\t},\n\n\t\t/* 清空canvas */\n\t\tclearCanvas() {\n\t\t\tthis.$nextTick(() => {\n\t\t\t\t// 重置画布\n\t\t\t\tthis.ctx.clearRect(0, 0, this.$refs['canvas'].width, this.$refs['canvas'].height);\n\t\t\t\t// 清空数据\n\t\t\t\tthis.$emit('change','')\n\t\t\t});\n\t\t},\n    /* 触摸结束，将未绘制的点清空防止对后续路径产生干扰 */\n\t\tmouseup() {\n\t\t\tthis.timerOut && clearTimeout(this.timerOut);\n\t\t\tthis.points = [];\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tconst blob = this.dataURLtoBlob(this.$refs.canvas.toDataURL('image/png'));\n\t\t\t\tblob.name = this.$uuid() + 'writingPad.png';\n\t\t\t\tthis.timerOut = setTimeout(() => {\n\t\t\t\t\tthis.uploadFile(blob);\n\t\t\t\t}, 1000);\n\t\t\t});\n\t\t},\n    /* base64转blob\n    * @param {String} baseurl base64\n    */\n    dataURLtoBlob(baseurl) {\n      let arr = baseurl.split(','),\n        mime = arr[0].match(/:(.*?);/)[1],\n        bstr = atob(arr[1]),\n        n = bstr.length,\n        u8arr = new Uint8Array(n);\n      while (n--) {\n        u8arr[n] = bstr.charCodeAt(n);\n      }\n      return new Blob([u8arr], {\n        type: mime\n      });\n    },\n    /* 上传文件\n\t\t * @param {Blob} file 文件\n\t\t */\n\t\tuploadFile(file) {\n\t\t\tthis.$refs.upload.uploadFile(true,file)\n\t\t},\n\t\t/* 上传失败 */\n\t\tuploadError(error){\n\t\t\tconsole.log(error)\n\t\t},\n\t\t/* 上传成功 */\n\t\tuploadChange(file){\n\t\t\tthis.$emit('change',file)\n\t\t},\n\n  },\n  mounted(){\n    this.initWritingPad()\n  },\n\tcomponents:{\n\t\tupload\n\t}\n}\n</script>\n<style lang=\"less\" scoped>\n  .writing {\n    &-pad {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      height: calc(100% - 40px);\n      border-bottom: 1px solid #e9eaf0;\n      .canvas {\n        width: 100%;\n        height: 100%;\n      }\n    }\n    &-clear {\n      height: 40px;\n      display: flex;\n      flex-direction: row-reverse;\n      color: @primary-color;\n      align-items: center;\n    }\n  }\n</style>"]}]}